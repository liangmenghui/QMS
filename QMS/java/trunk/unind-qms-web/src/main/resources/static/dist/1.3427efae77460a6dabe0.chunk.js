webpackJsonp([1],{1110:function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(15),n=s(a),i=o(23),r=s(i);t.default={props:["approvedItemRecord","type","data","needCoach"],data:function(){return{showFailedModel:!1,showSuccessModel:!1,showRejectModel:!1,isCoach:1,resultDesc:"",flowDesc:""}},created:function(){},methods:{showModel:function(e){3==e?this.showFailedModel=!0:2==e?this.showRejectModel=!0:this.showSuccessModel=!0},approved:function(e){var t=this;if(0!=e){var o={bsItemsId:this.approvedItemRecord.itemsBy.id,bsItemsRecordId:this.approvedItemRecord.id,bsResult:e,itemsDesc:this.flowDesc,resultDesc:this.resultDesc};this.needCoach&&(o.isCoach=this.isCoach),this.api.Audit.approved(o).then(function(o){t.$Message.info("提交审核结果完成"),t.bsStatus=e;var s=t.$route.matched[t.$route.matched.length-2].path,a={path:s,query:{bsFlowRecordId:t.$route.query.bsFlowRecordId}};t.$router.replace(a)})}},saveRecord:function(e){var t=this;if("audits"==this.type){for(var o=new Array,s=this.data,a=0;a<s.length;a++){var i={};i.bsItemsRecoreId=this.approvedItemRecord.id,i.bsTermsId=s[a].ID,i.bsScore=s[a].BS_SCORE,i.bsDesc=s[a].BS_DESC,void 0!=s[a].SCORE_ID&&(i.id=s[a].SCORE_ID),o.push(i)}(0,r.default)(o);this.api.Audit.records({approvedTermsScoreStr:(0,r.default)(o)}).then(function(o){t.$emit("updateTermsRecord"),t.$Message.info("保存成功"),t.approved(e)})}else if("inspect"==this.type){var l=(0,n.default)({},this.data);l=this.$Util.formattedParams(l),this.api.shipmentInspect.edit(l).then(function(o){t.$Message.info("保存成功"),t.approved(e)})}else if("quality"==this.type){var l=(0,n.default)({},this.data);l=this.$Util.formattedParams(l),this.api.qualityInspect.edit(l).then(function(o){t.$Message.info("保存成功"),t.approved(e)})}else this.approved(e)}}}},1111:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["approvedData"],data:function(){return{}}}},1152:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(1110),a=o.n(s);for(var n in s)"default"!==n&&function(e){o.d(t,e,function(){return s[e]})}(n);var i=o(1153),r=o.n(i),l=o(1),d=l(a.a,r.a,!1,null,null,null);d.options.__file="src\\components\\ApprovedAction.vue",t.default=d.exports},1153:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"component"},[o("center",[o("el-button",{staticStyle:{padding:"7px 20px"},attrs:{type:"primary"},on:{click:function(t){e.saveRecord(0)}}},[o("i",{staticClass:"el-icon-news"}),e._v("  "+e._s(e.$t("Button.SaveChanges"))+"\n        ")]),e._v(" "),e.approvedItemRecord.bsStep>1?o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"danger"},on:{click:function(t){e.showModel(2)}}},[o("i",{staticClass:"el-icon-close"}),e._v("  "+e._s(e.$t("Button.DismissReview"))+"\n        ")]):e._e(),e._v(" "),o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"danger"},on:{click:function(t){e.showModel(3)}}},[o("i",{staticClass:"el-icon-close"}),e._v("  "+e._s(e.$t("Button.AuditFailed"))+"\n        ")]),e._v(" "),o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"success"},on:{click:function(t){e.showModel(1)}}},[o("i",{staticClass:"el-icon-check"}),e._v("  "+e._s(e.$t("Button.Approved"))+"\n        ")]),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(3)}},model:{value:e.showFailedModel,callback:function(t){e.showFailedModel=t},expression:"showFailedModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#F56C6C"}},[e._v("确认当前审核失败？")]),e._v(" "),void 0!=e.flowDesc&&e.flowDesc.length>0?o("el-form-item",{attrs:{label:"结果说明"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"审核意见",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(1)}},model:{value:e.showSuccessModel,callback:function(t){e.showSuccessModel=t},expression:"showSuccessModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#67C23A"}},[e._v("确认当前审核通过？")]),e._v(" "),o("el-form-item",{attrs:{label:"结果说明",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"审核意见",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1),e._v(" "),e.needCoach?o("el-form-item",{attrs:{label:e.$t("supplier.coach")}},[o("el-select",{model:{value:e.isCoach,callback:function(t){e.isCoach=t},expression:"isCoach"}},[o("el-option",{attrs:{label:"是",value:1}}),e._v(" "),o("el-option",{attrs:{label:"否",value:2}})],1)],1):e._e()],1)],1),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(2)}},model:{value:e.showRejectModel,callback:function(t){e.showRejectModel=t},expression:"showRejectModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#67C23A"}},[e._v("驳回当前审核？")]),e._v(" "),o("el-form-item",{attrs:{label:"结果说明",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"审核意见",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1)],1)],1)},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.default=n},1154:function(e,t,o){"use strict";function s(e){d||o(1155)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1111),n=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);var r=o(1157),l=o.n(r),d=!1,c=o(1),p=s,u=c(n.a,l.a,!1,p,null,null);u.options.__file="src\\components\\approvedResultRecord.vue",t.default=u.exports},1155:function(e,t,o){var s=o(1156);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(28)("45c6c753",s,!1,{})},1156:function(e,t,o){t=e.exports=o(27)(!1),t.push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},1157:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"margin-top":"60px"}},[o("Card",[o("p",{attrs:{slot:"title"},slot:"title"},[e._v("审核状态: "+e._s(e.$t("approved.status["+e.approvedData.bsStatus+"]")))]),e._v(" "),o("p",{attrs:{slot:"title"},slot:"title"},[e._v("结果说明: "+e._s(e.approvedData.bsDesc))]),e._v(" "),e.approvedData.resultSet.length>0?o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.approvedData.resultSet}},[o("el-table-column",{attrs:{label:"审核结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(e.$t("product.bsResult["+(t.row.bsResult-1)+"]")))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"resultBy.bsName",label:"负责人"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bsDesc",label:"审核意见"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bsCreatedTime",label:"时间"}})],1)],1):e._e()])],1)},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.default=n},1520:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(15),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={props:["fileList","canUpload"],data:function(){return{dialogImageUrl:"",dialogVisible:!1,file:{}}},created:function(){this.form.fileSet=this.fileList.map(function(e){return e.name=e.fsFileBy.bsName+e.fsFileBy.bsFileType,e})},methods:{handleRemove:function(e,t){var o=this;if(e.id&&canUpload){var s={id:e.id};this.api.approvedItemsRecordFile.delete(s).then(function(e){e.result?(o.fileList.remove(),o.$Message.info("删除成功")):o.$Message.error(e.msg)})}},handleUpload:function(e){return this.file=e,this.getData(),!0},getData:function(){var e=this,t=new FormData;t.append("file",this.file),t.append("bsItemsRecordId",this.$route.query.itemsRecordId),this.api.approvedItemsRecordFile.add(t).then(function(t){if(t.result){var o=(0,a.default)(t.data,{name:e.file.name});e.fileList.push(o)}else e.$Message.error(t.msg)})},downloadFile:function(e){var t={fsFileId:e.fsFileId};this.api.fileQms.getfile(t).then(function(e){e.click()})}}}},1526:function(e,t,o){"use strict";function s(e){d||o(1527)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1520),n=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);var r=o(1529),l=o.n(r),d=!1,c=o(1),p=s,u=c(n.a,l.a,!1,p,null,null);u.options.__file="src\\components\\Upload.vue",t.default=u.exports},1527:function(e,t,o){var s=o(1528);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(28)("eb594478",s,!1,{})},1528:function(e,t,o){t=e.exports=o(27)(!1),t.push([e.i,"\n.Uploadbox{margin-top:15px;\n}\n.el-upload--text {\n    background-color: #fff;\n    border: none;\n    border-radius: 6px;\n    box-sizing: border-box;\n  \n    text-align: center;\n    cursor: pointer;\n    position: relative;\n}\n.el-upload-list__item{width: 60%;\n}\n\n",""])},1529:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-upload",{staticClass:"upload-demo",attrs:{action:"","before-upload":e.handleUpload,"on-preview":e.downloadFile,"on-remove":e.handleRemove,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"success",plain:"",icon:"el-icon-plus",disabled:!e.canUpload}},[e._v("\r\n    "+e._s(e.$t("upcoming.UploadAttachment"))+"\r\n  ")]),e._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.default=n},1608:function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1526),n=s(a),i=o(1152),r=s(i),l=o(24),d=s(l),c=o(1154),p=s(c);t.default={data:function(){return{AuditFailedModal:!1,AuditFailedForm:{},ApprovedForm:{},audits:{},approvedItemData:{itemsRecordId:0,itemsId:0},terms:[],dialogImageUrl:"",dialogVisible:!1,approvedItemRecord:{},productInfo:{},supplierInfo:{},perms:{edit:!1}}},created:function(){this.approvedItemRecord=this.$store.getters.getItemRecordData,this.approvedItemRecord.bsSuppId?this.supplierInfo=this.$store.getters.getSupplierData:this.productInfo=this.$store.getters.getProductData,void 0==this.approvedItemRecord.fileSet&&(this.approvedItemRecord.fileSet=[]),this.approvedItemData=this.$route.query,this.getData(),this.perms.edit=(this.approvedItemRecord.users.includes(d.default.get("user"))||this.Util.hasPerm("VERIFY"))&&1==this.approvedItemRecord.bsStatus},beforeUpdate:function(){this.showRooterView=this.$route.matched.length>3},watch:{$route:function(e,t){this.showRooterView=e.matched.length>3}},components:{Upload:n.default,ApprovedAction:r.default,approvedResultRecord:p.default},methods:{getData:function(){var e=this;this.api.Audit.getlist(this.approvedItemData).then(function(t){e.terms=t.data})},updateTermsRecord:function(e){this.getData()}}}},1806:function(e,t,o){var s=o(1807);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(28)("6a5a4473",s,!1,{})},1807:function(e,t,o){t=e.exports=o(27)(!1),t.push([e.i,'\n.layout-content{padding:20px;background: #fff\n}\n.uploadtext{float: left;margin-right: 20px;font-size: 14px;\n}\n.uploadtxt .el-upload-dragger{border:none;\n}\n.fileList .el-upload-list__item {\n    margin-top: 10px;\n    margin-left: 65px;\n    padding: 10px;\n    border: 1px dashed #ccc;\n}\n.fltxt{float :left;display: inline-block;\n}\n.frtxt{float: right; text-align: right; margin-bottom: 10px;\n}\n.el-table .cell{font-family: "Microsoft YaHei"\n}\n.el-table th{background: #f2f7fb;\n}\n.productInfo{font-size: 14px;margin-bottom: 10px;\n}\n.productInfo .el-icon-info{font-size: 18px;color: #269ddd;margin-right: 10px;\n}\n\n',""])},1808:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"layout-content",staticStyle:{height:"100%","background-color":"white"}},[o("div",{staticStyle:{height:"60px","font-size":"16px"}},[o("center",[o("h4",[e._v("试产场地审核")])])],1),e._v(" "),e.approvedItemRecord.bsPrId?o("div",[o("Col",{staticClass:"productInfo",attrs:{md:10}},[o("i",{staticClass:"el-icon-info"}),o("b",[e._v(e._s(e.$t("product.name"))+":")]),e._v(" "+e._s(e.productInfo.bsPrName))]),e._v(" "),o("Col",{staticClass:"productInfo",attrs:{md:4}},[o("span",[o("b",[e._v(e._s(e.$t("product.code"))+":")]),e._v(" "+e._s(e.productInfo.bsPrCode))])])],1):e._e(),e._v(" "),e.approvedItemRecord.bsSuppId?o("div",{staticClass:"fltxt"},[o("Col",{attrs:{md:4}},[o("h5",{staticStyle:{"font-size":"14px"}},[e._v(e._s(e.$t("product.SuppChieseName"))+": "+e._s(e.supplierInfo.bsSuppChieseName)+" | "+e._s(e.supplierInfo.bsSuppEnglishName))])]),e._v(" "),o("Col",{attrs:{md:4}},[o("h5",{staticStyle:{"font-size":"14px"}},[e._v(e._s(e.$t("product.SuppCode"))+": "+e._s(e.supplierInfo.bsSuppCode))])])],1):e._e(),e._v(" "),e.perms.edit?e._e():o("div",{staticClass:"frtxt"},[o("Tag",{attrs:{type:"dot",color:"blue"}},[e._v(e._s(e.$t("approved.statusLabel"))+" : "+e._s(e.$t("approved.status["+e.approvedItemRecord.bsStatus+"]")))])],1),e._v(" "),o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.terms}},[o("el-table-column",{attrs:{prop:"BS_NO",label:e.$t("New-audit.Article-number"),align:"center",width:"110"}}),e._v(" "),o("el-table-column",{attrs:{prop:"BS_CONTENT",label:e.$t("New-audit.Terms-conditions")}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("New-audit.Auditscore")},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{readonly:!e.perms.edit},model:{value:t.row.BS_SCORE,callback:function(o){e.$set(t.row,"BS_SCORE",o)},expression:"scope.row.BS_SCORE"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("New-audit.AuditInstructions")},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{type:"textarea",autosize:{minRows:1.3},readonly:!e.perms.edit},model:{value:t.row.BS_DESC,callback:function(o){e.$set(t.row,"BS_DESC",o)},expression:"scope.row.BS_DESC"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"BS_STANDARD",label:e.$t("New-audit.Grading")}})],1)],1),e._v(" "),o("div",{staticClass:"uploadtxt",staticStyle:{"margin-top":"60px"}},[o("h6",{staticClass:"uploadtext"},[e._v(e._s(e.$t("upcoming.UploadAttachment")))]),e._v(" "),o("div",{staticClass:"fileList",staticStyle:{padding:"0 15px"}},[o("upload",{attrs:{fileList:e.approvedItemRecord.fileSet,canUpload:e.perms.edit}})],1)]),e._v(" "),o("approvedResultRecord",{attrs:{approvedData:e.approvedItemRecord}}),e._v(" "),e.perms.edit?o("div",{staticStyle:{"margin-top":"100px","margin-bottom":"200px"}},[o("ApprovedAction",{attrs:{type:"audits",data:e.terms,approvedItemRecord:e.approvedItemRecord},on:{updateTermsRecord:e.updateTermsRecord}})],1):e._e()],1)},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.default=n},444:function(e,t,o){"use strict";function s(e){d||o(1806)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1608),n=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);var r=o(1808),l=o.n(r),d=!1,c=o(1),p=s,u=c(n.a,l.a,!1,p,null,null);u.options.__file="src\\view\\approved\\ApprovedItemRecordDetails.vue",t.default=u.exports}});