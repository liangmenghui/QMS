webpackJsonp([2],{1581:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});r(120);e.default={data:function(){var t=this;return{itemNumList:[],suppliers:[],proxies:[],customers:[],formQuery:{provider:"",startDay:"",endDay:""},formDetail:{visible:!1},formAdd:{visible:!1},form:{provider:"",customer:"",factory:"",proxyDesc:"",customerDesc:"",supplierDesc:"",items:[]},formValidateRule:{provider:[{required:!0,message:"请选择代理商",trigger:"change"}],customer:[{required:!0,message:"请选择客户",trigger:"change"}],factory:[{required:!0,message:"请选择供应商",trigger:"change"}]},datagrid:{queryParams:{page:1,rows:25,pkParent:-1},pagination:[25,50,100],data:{rows:[],total:0},columns:[{key:"bsProvider",title:"代理商代码"},{key:"bsProxyDesc",title:"代理商"},{key:"bsCustomer",title:"客户代码"},{key:"bsCustomerDesc",title:"客户"},{key:"bsFactory",title:"供应商代码"},{key:"bsSupplierDesc",title:"供应商"},{key:"bsCommitState",title:"状态",render:function(t,e){var r="";switch(e.row.bsCommitState){case 0:r="处理中";break;case 1:r="客户已确认";break;case 2:r="货代已确认";break;case 3:r="供应商已确认"}return t("span",r)}},{key:"bsStartDay",title:"订仓开始时间"},{key:"bsEndDay",title:"订仓结束时间"},{key:"bsShippingCount",title:"出货次数"},{key:"bsTotalQty",title:"出货数量"},{key:"action",title:"操作",render:function(e,r){var o=[];return o.push(e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleRowDetail(r)}}},"详细")),o.push(e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleRowDelete(r)}}},"删除")),e("div",o)}}]}}},mounted:function(){this.loadCustomer(),this.loadProxies(),this.loadSuppliers()},methods:{handleFormToolbarAddLastRow:function(){this.form.items.push({bsItemNum:"",bsQty:"",bsDay:""})},handleFormToolbarRemoveRow:function(){},handleFormToolbarRemoveLastRow:function(){this.form.items.length>0&&this.form.items.splice(this.form.items.length-1,1)},changePage:function(t){this.datagrid.queryParams.page=t,this.datagrid.data=this.handleQuery()},handleQuery:function(){var t=this;this.datagrid.data={rows:[],total:0},this.api.lmp.bookingforecast.list(this.formQuery).then(function(e){e.result&&(t.datagrid.data=e.data)})},handleForm:function(){for(var t=[],e=0;e<2;e++)t.push({bsItemNum:"",bsQty:"",bsDay:""});this.form.provider="",this.form.customer="",this.form.factory="",this.form.items=t,this.formAdd.visible=!0},handleFormOk:function(){var t=this;this.$refs.form.validate(function(e){0!=e&&(t.form.proxyDesc=t.proxies.find(function(e){return e.bsProvider==t.form.provider}).bsProviderDesc,t.form.customerDesc=t.customers.find(function(e){return e.bsCustomer==t.form.customer}).bsCustomerDesc,t.form.supplierDesc=t.suppliers.find(function(e){return e.bsFactory==t.form.factory}).bsFactoryDesc,t.api.lmp.bookingforecast.save(t.form).then(function(e){e.result&&(t.$Message.info("保存成功."),t.$Modal.remove())}))})},handleRowDetail:function(t){this.form.provider="",this.form.customer="",this.form.factory="",this.form.items=itemList,this.api.lmp.bookingforecast.detail({id:t.row.id})},handleRowDelete:function(t){var e=this;t.row.bsCommitState>0?this.$Modal.confirm({title:"确认删除",content:"<p>当前订仓信息已提交给代理商，<br/>如果刪除需要与代理商沟通取消订仓信息！<br/>请确认是否继续删除?</p>",onOk:function(){e.api.lmp.bookingforecast.remove({id:t.row.id})}}):this.$Modal.confirm({title:"确认删除",content:"<p>刪除后將不可恢复，请确认是否继续?</p>",onOk:function(){e.api.lmp.bookingforecast.remove({id:t.row.id})}})},loadCustomer:function(){this.customers=[{bsCustomerDesc:"请选择客户",bsCustomer:""},{bsCustomerDesc:"测试1",bsCustomer:"TEST"}]},loadProxies:function(){this.proxies=[{bsProviderDesc:"请选择",bsProvider:""},{bsProviderDesc:"测试代理商",bsProvider:"TestProxy"}]},loadSuppliers:function(){this.suppliers=[{bsFactoryDesc:"请选择",bsFactory:""},{bsFactoryDesc:"测试供应商",bsFactory:"TestFactory"}]},handleItemNumQuery:function(){}},directives:{focus:{inserted:function(t,e){e.value?t.focus():t.blur()},componentUpdated:function(t,e){e.modifiers.lazy&&Boolean(e.value)===Boolean(e.oldValue)||(e.value?t.focus():t.blur())}}},computed:{formItemLength:function(){return this.form.items.length}},watch:{formItemLength:function(t,e){var r=this;this.$nextTick(function(){if(t!=e){r.$refs.box.scrollTop=r.$refs.box.scrollHeight;var o=3*(r.form.items.length-1);r.$refs.input[o].focus()}})}}}},1744:function(t,e,r){var o=r(1745);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);r(28)("d9475494",o,!1,{})},1745:function(t,e,r){e=t.exports=r(27)(!1),e.push([t.i,"\n.ivu-modal h3 {\r\n  line-height: 62px;\r\n  height: 62px;\r\n  font-size: 23px;\r\n  padding-left: 20px;\r\n  margin-bottom: 20px;\n}\n.ivu-modal .box {\r\n  font-size: 14px;\r\n  margin: 0px 10px 10px 10px;\r\n  padding: 2px 6px;\r\n  height: 410px;\r\n  overflow-y: auto;\r\n  background-color: #f8f8f9;\n}\n.ivu-modal .toolbar {\r\n  padding: 0px 6px 24px 6px;\r\n  margin-left: 43px;\n}\n.ivu-modal .code-row-bg {\r\n  padding: 0px;\r\n  margin: 2px;\n}\r\n",""])},1746:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",[r("i-col",[r("Form",{staticClass:"query_area",attrs:{model:t.formQuery,"label-width":120,inline:""}},[r("Form-Item",{attrs:{label:"代理商"}},[r("Select",{staticStyle:{width:"140px"},model:{value:t.formQuery.provider,callback:function(e){t.$set(t.formQuery,"provider",e)},expression:"formQuery.provider"}},t._l(t.proxies,function(e){return r("Option",{key:e.bsProvider,attrs:{value:e.bsProvider}},[t._v(t._s(e.bsProviderDesc))])}))],1),t._v(" "),r("Form-Item",{attrs:{label:"日期"}},[r("Row",[r("i-col",{attrs:{span:"11"}},[r("Form-Item",{attrs:{prop:"startDay"}},[r("DatePicker",{attrs:{format:"yyyy/MM/dd",placeholder:"请选择日期"},model:{value:t.formQuery.startDay,callback:function(e){t.$set(t.formQuery,"startDay",e)},expression:"formQuery.startDay"}})],1)],1),t._v(" "),r("i-col",{attrs:{span:"2"}},[r("span",{staticStyle:{width:"20px","text-align":"center",display:"inline-block"}},[t._v("-")])]),t._v(" "),r("i-col",{attrs:{span:"11"}},[r("Form-Item",{attrs:{prop:"endDay"}},[r("DatePicker",{attrs:{format:"yyyy/MM/dd",placeholder:"请选择日期",number:"true"},model:{value:t.formQuery.endDay,callback:function(e){t.$set(t.formQuery,"endDay",e)},expression:"formQuery.endDay"}})],1)],1)],1)],1),t._v(" "),r("FormItem",{staticStyle:{}},[r("Row",{attrs:{gutter:24}},[r("i-col",{attrs:{span:"12"}},[r("Button",{attrs:{type:"primary"},on:{click:t.handleQuery}},[t._v("查询")])],1),t._v(" "),r("i-col",{attrs:{span:"12"}},[r("Button",{attrs:{type:"primary"},on:{click:t.handleForm}},[t._v("新增")])],1)],1)],1)],1)],1)],1),t._v(" "),r("Row",[r("i-col",{staticStyle:{padding:"1px"},attrs:{span:"24"}},[r("Table",{attrs:{data:t.datagrid.data.rows,columns:t.datagrid.columns,stripe:"",height:"700"}}),t._v(" "),r("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[r("div",{staticStyle:{float:"right"}},[r("Page",{attrs:{total:t.datagrid.data.total,current:1,"page-size":t.datagrid.queryParams.rows,"page-size-opts":t.datagrid.pagination,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage}})],1)])],1)],1),t._v(" "),r("Modal",{attrs:{width:"1100","ok-text":"保  存","cancel-text":"关  闭"},model:{value:t.formAdd.visible,callback:function(e){t.$set(t.formAdd,"visible",e)},expression:"formAdd.visible"}},[r("h3",[t._v("新增 BOOKING FORECAST")]),t._v(" "),r("Form",{ref:"form",attrs:{model:t.form,rules:t.formValidateRule,"label-width":100,inline:""}},[r("Form-Item",{attrs:{label:"代理",prop:"provider"}},[r("Select",{staticStyle:{width:"140px"},model:{value:t.form.provider,callback:function(e){t.$set(t.form,"provider",e)},expression:"form.provider"}},t._l(t.proxies,function(e){return r("Option",{key:e.bsProvider,attrs:{value:e.bsProvider}},[t._v(t._s(e.bsProviderDesc))])}))],1),t._v(" "),r("Form-Item",{attrs:{label:"客户",prop:"customer"}},[r("Select",{staticStyle:{width:"140px"},model:{value:t.form.customer,callback:function(e){t.$set(t.form,"customer",e)},expression:"form.customer"}},t._l(t.customers,function(e){return r("Option",{key:e.bsCustomer,attrs:{value:e.bsCustomer}},[t._v(t._s(e.bsCustomerDesc))])}))],1),t._v(" "),r("Form-Item",{attrs:{label:"供应商",prop:"factory"}},[r("Select",{staticStyle:{width:"140px"},model:{value:t.form.factory,callback:function(e){t.$set(t.form,"factory",e)},expression:"form.factory"}},t._l(t.suppliers,function(e){return r("Option",{key:e.bsFactory,attrs:{value:e.bsFactory}},[t._v(t._s(e.bsFactoryDesc))])}))],1),t._v(" "),r("div",{staticClass:"toolbar"},[r("tooltip",{attrs:{content:"新增一行",placement:"top-start"}},[r("i-button",{attrs:{type:"ghost",icon:"ios-plus-empty"},on:{click:t.handleFormToolbarAddLastRow}})],1),t._v(" "),r("tooltip",{attrs:{content:"删除最后一行",placement:"top-start"}},[r("i-button",{attrs:{type:"ghost",icon:"ios-trash"},on:{click:t.handleFormToolbarRemoveLastRow}})],1)],1),t._v(" "),r("div",{ref:"box",staticClass:"box"},t._l(t.form.items,function(e,o){return r("Row",{key:o,attrs:{"class-name":"code-row-bg"}},[r("i-col",{attrs:{span:"8"}},[r("Form-Item",{attrs:{label:"料号",prop:"items."+o+".bsItemNum",rules:{required:!0,pattern:"^[0-9a-zA-Z]{0,22}$",message:"请输入正确的物料料号",trigger:"blur"}}},[r("Input",{ref:"input",refInFor:!0,attrs:{placeholder:"请输入出货物料料号"},model:{value:e.bsItemNum,callback:function(r){t.$set(e,"bsItemNum",r)},expression:"item.bsItemNum"}})],1)],1),t._v(" "),r("i-col",{attrs:{span:"8"}},[r("Form-Item",{attrs:{label:"出货数量",prop:"items."+o+".bsQty",rules:{type:"number",required:!0,message:"请输入正确的出货数量",trigger:"blur",transform:function(t){return Number(t)}}}},[r("Input",{ref:"input",refInFor:!0,attrs:{placeholder:"请输入出货数量"},model:{value:e.bsQty,callback:function(r){t.$set(e,"bsQty",r)},expression:"item.bsQty"}})],1)],1),t._v(" "),r("i-col",{attrs:{span:"8"}},[r("Form-Item",{attrs:{label:"出货日期",prop:"items."+o+".bsDay",rules:{required:!0,pattern:"^[0-9]{4}-[0-9]{2}-[0-9]{2}",message:"请输入正确的出货日期",trigger:"blur"}}},[r("Input",{ref:"input",refInFor:!0,attrs:{placeholder:"请输入出货日期",type:"date"},model:{value:e.bsDay,callback:function(r){t.$set(e,"bsDay",r)},expression:"item.bsDay"}})],1)],1)],1)}))],1),t._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:t.handleFormOk}},[t._v("保 存")])],1)],1),t._v(" "),r("Modal",{attrs:{width:"1100"},model:{value:t.formDetail.visible,callback:function(e){t.$set(t.formDetail,"visible",e)},expression:"formDetail.visible"}},[r("h3",[t._v("BOOKING FORECAST")]),t._v(" "),r("Form",{attrs:{model:t.form,"label-width":100,inline:""}},[r("Form-Item",{attrs:{label:"代理"}},[r("i-input",{staticStyle:{width:"140px"},attrs:{readonly:"true"},model:{value:t.form.provider,callback:function(e){t.$set(t.form,"provider",e)},expression:"form.provider"}})],1),t._v(" "),r("Form-Item",{attrs:{label:"客户"}},[r("i-input",{staticStyle:{width:"140px"},attrs:{readonly:"true"},model:{value:t.form.customer,callback:function(e){t.$set(t.form,"customer",e)},expression:"form.customer"}})],1),t._v(" "),r("Form-Item",{attrs:{label:"供应商"}},[r("i-input",{staticStyle:{width:"140px"},attrs:{readonly:"true"},model:{value:t.form.factory,callback:function(e){t.$set(t.form,"factory",e)},expression:"form.factory"}})],1),t._v(" "),r("div",{staticClass:"box"},t._l(t.form.items,function(e,o){return r("Row",{key:o,attrs:{"class-name":"code-row-bg"}},[r("i-col",{attrs:{span:"8"}},[r("Form-Item",{attrs:{label:"料号"}},[r("Input",{staticStyle:{width:"140px"},attrs:{readonly:"true"},model:{value:e.bsItemNum,callback:function(r){t.$set(e,"bsItemNum",r)},expression:"item.bsItemNum"}})],1)],1),t._v(" "),r("i-col",{attrs:{span:"8"}},[r("Form-Item",{attrs:{label:"出货数量"}},[r("Input",{staticStyle:{width:"140px"},attrs:{readonly:"true"},model:{value:e.bsQty,callback:function(r){t.$set(e,"bsQty",r)},expression:"item.bsQty"}})],1)],1),t._v(" "),r("i-col",{attrs:{span:"8"}},[r("Form-Item",{attrs:{label:"出货日期"}},[r("Input",{staticStyle:{width:"140px"},attrs:{readonly:"true"},model:{value:e.bsDay,callback:function(r){t.$set(e,"bsDay",r)},expression:"item.bsDay"}})],1)],1)],1)}))],1)],1)],1)},s=[];o._withStripped=!0;var a={render:o,staticRenderFns:s};e.default=a},437:function(t,e,r){"use strict";function o(t){c||r(1744)}Object.defineProperty(e,"__esModule",{value:!0});var s=r(1581),a=r.n(s);for(var i in s)"default"!==i&&function(t){r.d(e,t,function(){return s[t]})}(i);var n=r(1746),l=r.n(n),c=!1,m=r(1),u=o,d=m(a.a,l.a,!1,u,null,null);d.options.__file="src\\view\\logistics\\booking\\forecast\\list.vue",e.default=d.exports}});