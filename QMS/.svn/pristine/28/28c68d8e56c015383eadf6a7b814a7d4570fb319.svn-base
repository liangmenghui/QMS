webpackJsonp([0],{1110:function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(15),a=s(n),i=o(23),r=s(i);t.default={props:["approvedItemRecord","type","data","needCoach"],data:function(){return{showFailedModel:!1,showSuccessModel:!1,showRejectModel:!1,isCoach:1,resultDesc:"",flowDesc:""}},created:function(){},methods:{showModel:function(e){3==e?this.showFailedModel=!0:2==e?this.showRejectModel=!0:this.showSuccessModel=!0},approved:function(e){var t=this;if(0!=e){var o={bsItemsId:this.approvedItemRecord.itemsBy.id,bsItemsRecordId:this.approvedItemRecord.id,bsResult:e,itemsDesc:this.flowDesc,resultDesc:this.resultDesc};this.needCoach&&(o.isCoach=this.isCoach),this.api.Audit.approved(o).then(function(o){t.$Message.info("提交审核结果完成"),t.bsStatus=e;var s=t.$route.matched[t.$route.matched.length-2].path,n={path:s,query:{bsFlowRecordId:t.$route.query.bsFlowRecordId}};t.$router.replace(n)})}},saveRecord:function(e){var t=this;if("audits"==this.type){for(var o=new Array,s=this.data,n=0;n<s.length;n++){var i={};i.bsItemsRecoreId=this.approvedItemRecord.id,i.bsTermsId=s[n].ID,i.bsScore=s[n].BS_SCORE,i.bsDesc=s[n].BS_DESC,void 0!=s[n].SCORE_ID&&(i.id=s[n].SCORE_ID),o.push(i)}(0,r.default)(o);this.api.Audit.records({approvedTermsScoreStr:(0,r.default)(o)}).then(function(o){t.$emit("updateTermsRecord"),t.$Message.info("保存成功"),t.approved(e)})}else if("inspect"==this.type){var l=(0,a.default)({},this.data);l=this.$Util.formattedParams(l),this.api.shipmentInspect.edit(l).then(function(o){t.$Message.info("保存成功"),t.approved(e)})}else if("quality"==this.type){var l=(0,a.default)({},this.data);l=this.$Util.formattedParams(l),this.api.qualityInspect.edit(l).then(function(o){t.$Message.info("保存成功"),t.approved(e)})}else this.approved(e)}}}},1111:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["approvedData"],data:function(){return{}}}},1152:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(1110),n=o.n(s);for(var a in s)"default"!==a&&function(e){o.d(t,e,function(){return s[e]})}(a);var i=o(1153),r=o.n(i),l=o(1),d=l(n.a,r.a,!1,null,null,null);d.options.__file="src\\components\\ApprovedAction.vue",t.default=d.exports},1153:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"component"},[o("center",[o("el-button",{staticStyle:{padding:"7px 20px"},attrs:{type:"primary"},on:{click:function(t){e.saveRecord(0)}}},[o("i",{staticClass:"el-icon-news"}),e._v("  "+e._s(e.$t("Button.SaveChanges"))+"\n        ")]),e._v(" "),e.approvedItemRecord.bsStep>1?o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"danger"},on:{click:function(t){e.showModel(2)}}},[o("i",{staticClass:"el-icon-close"}),e._v("  "+e._s(e.$t("Button.DismissReview"))+"\n        ")]):e._e(),e._v(" "),o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"danger"},on:{click:function(t){e.showModel(3)}}},[o("i",{staticClass:"el-icon-close"}),e._v("  "+e._s(e.$t("Button.AuditFailed"))+"\n        ")]),e._v(" "),o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"success"},on:{click:function(t){e.showModel(1)}}},[o("i",{staticClass:"el-icon-check"}),e._v("  "+e._s(e.$t("Button.Approved"))+"\n        ")]),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(3)}},model:{value:e.showFailedModel,callback:function(t){e.showFailedModel=t},expression:"showFailedModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#F56C6C"}},[e._v("确认当前审核失败？")]),e._v(" "),void 0!=e.flowDesc&&e.flowDesc.length>0?o("el-form-item",{attrs:{label:"结果说明"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"审核意见",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(1)}},model:{value:e.showSuccessModel,callback:function(t){e.showSuccessModel=t},expression:"showSuccessModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#67C23A"}},[e._v("确认当前审核通过？")]),e._v(" "),o("el-form-item",{attrs:{label:"结果说明",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"审核意见",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1),e._v(" "),e.needCoach?o("el-form-item",{attrs:{label:e.$t("supplier.coach")}},[o("el-select",{model:{value:e.isCoach,callback:function(t){e.isCoach=t},expression:"isCoach"}},[o("el-option",{attrs:{label:"是",value:1}}),e._v(" "),o("el-option",{attrs:{label:"否",value:2}})],1)],1):e._e()],1)],1),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(2)}},model:{value:e.showRejectModel,callback:function(t){e.showRejectModel=t},expression:"showRejectModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#67C23A"}},[e._v("驳回当前审核？")]),e._v(" "),o("el-form-item",{attrs:{label:"结果说明",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"审核意见",prop:""}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1)],1)],1)},n=[];s._withStripped=!0;var a={render:s,staticRenderFns:n};t.default=a},1154:function(e,t,o){"use strict";function s(e){d||o(1155)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1111),a=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);var r=o(1157),l=o.n(r),d=!1,p=o(1),c=s,u=p(a.a,l.a,!1,c,null,null);u.options.__file="src\\components\\approvedResultRecord.vue",t.default=u.exports},1155:function(e,t,o){var s=o(1156);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(28)("45c6c753",s,!1,{})},1156:function(e,t,o){t=e.exports=o(27)(!1),t.push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},1157:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"margin-top":"60px"}},[o("Card",[o("p",{attrs:{slot:"title"},slot:"title"},[e._v("审核状态: "+e._s(e.$t("approved.status["+e.approvedData.bsStatus+"]")))]),e._v(" "),o("p",{attrs:{slot:"title"},slot:"title"},[e._v("结果说明: "+e._s(e.approvedData.bsDesc))]),e._v(" "),e.approvedData.resultSet.length>0?o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.approvedData.resultSet}},[o("el-table-column",{attrs:{label:"审核结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(e.$t("product.bsResult["+(t.row.bsResult-1)+"]")))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"resultBy.bsName",label:"负责人"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bsDesc",label:"审核意见"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bsCreatedTime",label:"时间"}})],1)],1):e._e()])],1)},n=[];s._withStripped=!0;var a={render:s,staticRenderFns:n};t.default=a},1520:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(15),n=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={props:["fileList","canUpload"],data:function(){return{dialogImageUrl:"",dialogVisible:!1,file:{}}},created:function(){this.form.fileSet=this.fileList.map(function(e){return e.name=e.fsFileBy.bsName+e.fsFileBy.bsFileType,e})},methods:{handleRemove:function(e,t){var o=this;if(e.id&&canUpload){var s={id:e.id};this.api.approvedItemsRecordFile.delete(s).then(function(e){e.result?(o.fileList.remove(),o.$Message.info("删除成功")):o.$Message.error(e.msg)})}},handleUpload:function(e){return this.file=e,this.getData(),!0},getData:function(){var e=this,t=new FormData;t.append("file",this.file),t.append("bsItemsRecordId",this.$route.query.itemsRecordId),this.api.approvedItemsRecordFile.add(t).then(function(t){if(t.result){var o=(0,n.default)(t.data,{name:e.file.name});e.fileList.push(o)}else e.$Message.error(t.msg)})},downloadFile:function(e){var t={fsFileId:e.fsFileId};this.api.fileQms.getfile(t).then(function(e){e.click()})}}}},1526:function(e,t,o){"use strict";function s(e){d||o(1527)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1520),a=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);var r=o(1529),l=o.n(r),d=!1,p=o(1),c=s,u=p(a.a,l.a,!1,c,null,null);u.options.__file="src\\components\\Upload.vue",t.default=u.exports},1527:function(e,t,o){var s=o(1528);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(28)("eb594478",s,!1,{})},1528:function(e,t,o){t=e.exports=o(27)(!1),t.push([e.i,"\n.Uploadbox{margin-top:15px;\n}\n.el-upload--text {\n    background-color: #fff;\n    border: none;\n    border-radius: 6px;\n    box-sizing: border-box;\n  \n    text-align: center;\n    cursor: pointer;\n    position: relative;\n}\n.el-upload-list__item{width: 60%;\n}\n\n",""])},1529:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-upload",{staticClass:"upload-demo",attrs:{action:"","before-upload":e.handleUpload,"on-preview":e.downloadFile,"on-remove":e.handleRemove,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"success",plain:"",icon:"el-icon-plus",disabled:!e.canUpload}},[e._v("\r\n    "+e._s(e.$t("upcoming.UploadAttachment"))+"\r\n  ")]),e._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)},n=[];s._withStripped=!0;var a={render:s,staticRenderFns:n};t.default=a},1610:function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(24),a=s(n),i=o(1526),r=s(i),l=o(1152),d=s(l),p=o(1154),c=s(p);t.default={components:{ApprovedAction:d.default,Upload:r.default,ApprovedResultRecord:c.default},data:function(){return{dialogImageUrl:"",dialogVisible:!1,file:{},perms:{},approvedItemRecord:{},needCoach:!1}},created:function(){this.approvedItemRecord=this.$store.getters.getItemRecordData,this.needCoach=this.$route.path.includes("preApproved")&&this.approvedItemRecord.users[this.approvedItemRecord.users.length-1]==a.default.get("user"),this.approvedItemRecord.bsSuppId?this.supplierInfo=this.$store.getters.getSupplierData:this.productInfo=this.$store.getters.getProductData,void 0==this.approvedItemRecord.fileSet&&(this.approvedItemRecord.fileSet=[]),this.perms.edit=(this.approvedItemRecord.users[this.approvedItemRecord.bsStep-1]==a.default.get("user")||this.Util.hasPerm("EDIT"))&&1==this.approvedItemRecord.bsStatus},methods:{handleRemove:function(e,t){var o=this,s={fsFileId:e.fsFileId};this.api.approvedItemsRecordFile.delete(s).then(function(e){o.fileList.remove(),o.$Message.info("删除成功")})},handleUpload:function(e){return this.file=e,this.getData(),!1}}}},1812:function(e,t,o){var s=o(1813);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(28)("7136902e",s,!1,{})},1813:function(e,t,o){t=e.exports=o(27)(!1),t.push([e.i,"\n.approvedextrareports #other-body{\n\t\tmargin-top: 1px;background-color: white;\n}\n.approvedextrareports #other-body-div1{\n\t\tfont-size: 14px;\n\t\tpadding-top: 20px;padding-left: 1%;padding-right: 1%;\n}\n.approvedextrareports .td1{\n\t\twidth: 25%;\n\t\theight: 50px;\n\t\ttext-align: center;\n}\n.approvedextrareports #bottom{\n\t\tbackground-color: white;padding-top: 60px;padding-bottom:100px;padding-left: 5%;\n}\n.td{padding: 10px; text-align:center;\n}\n.td .el-upload--text{\n\t\tborder: none;\n\t\tdisplay: inline-block;\n\t\twidth: 90px;\n\t\theight: 50px;\n\t\tfloat: left;\n\t\tmargin-left: 10px;\n}\n.upload  .el-upload--text{\n\t\tborder: none;\n\t\tdisplay: inline-block;\n\t\theight:50px;\n\t\twidth: 20%;\n\t\tbackground: none;\t\n\t\tposition: absolute;\n\t\tright:8%;\n\t\ttop:10px;\n\t\tmargin-left: 10px;\n}\n.fileList2 .el-upload-list{\n\t\tmargin-top:35px;\t\n    \t\n   \t\t padding: 10px;\n   \t\t border: 1px dashed #ccc;\n   \t\t width: 80%;\n}\n.fileList2 .el-upload-list__item{width:80%;\n}\n",""])},1814:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"approvedextrareports"},[o("Row",{style:{marginBottom:"20px"}},[o("center",[o("h4",{staticStyle:{"font-size":"16px"}},[e._v("其他审核报告")])])],1),e._v(" "),o("Row",{style:{marginBottom:"20px"}},[o("Card",[o("p",{attrs:{slot:"title"},slot:"title"},[o("Icon",{staticStyle:{color:"#ff9900"},attrs:{type:"pricetag"}}),e._v("\n                     "+e._s(e.approvedItemRecord.itemsBy.bsName)+"\n               \t")],1),e._v(" "),o("div",{attrs:{id:"other-body"}},[o("div",{attrs:{id:"other-body-div1"}},[o("div",{staticClass:"fileList2",staticStyle:{padding:"0 15px"}},[o("upload",{attrs:{fileList:e.approvedItemRecord.fileSet,canUpload:e.perms.edit}})],1)])]),e._v(" "),o("approvedResultRecord",{attrs:{approvedData:e.approvedItemRecord}}),e._v(" "),e.perms.edit?o("div",{attrs:{id:"bottom"}},[o("ApprovedAction",{attrs:{approvedItemRecord:e.approvedItemRecord,needCoach:e.needCoach}})],1):e._e()],1)],1)],1)},n=[];s._withStripped=!0;var a={render:s,staticRenderFns:n};t.default=a},76:function(e,t,o){"use strict";function s(e){d||o(1812)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1610),a=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);var r=o(1814),l=o.n(r),d=!1,p=o(1),c=s,u=p(a.a,l.a,!1,c,null,null);u.options.__file="src\\view\\approved\\ApprovedExtraReports.vue",t.default=u.exports}});