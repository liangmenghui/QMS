webpackJsonp([14,86],{1153:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(1702),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);var r=a(1713),s=a.n(r),d=a(1),c=d(i.a,s.a,!1,null,null,null);c.options.__file="src/view/logistics/booking/generate.vue",e.default=c.exports},1205:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(1788),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);var r=a(2096),s=a.n(r),d=a(1),c=d(i.a,s.a,!1,null,null,null);c.options.__file="src/view/logistics/infrastruct/preplan.vue",e.default=c.exports},1702:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(17),i=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default={props:{cabinets:{type:[Object,Array],required:!0}},data:function(){return{currentContextView:"",mutliAgent:!1,initializeState:!1,validateResult:!0,loading:!1,agents:[{agent:"",desc:"请选择货代"}],form:{customer:"",agent:""},content:""}},methods:{handleSubmit:function(){var t=this.$refs.content.getData;if(!t)return void this.$Message.error("插件错误,未实现 getData");t()},handleCommit:function(t){var e=this;(0,i.default)(t)&&this.api.lmp.booking.saveContent({customer:this.form.customer,agent:this.form.agent,formData:(0,i.default)(t)}).then(function(t){t.result&&(e.$Message.success("保存成功"),e.modalHidden())})},initCustomer:function(){var t=this;this.api.lmp.booking.getCustomerByPlan(this.cabinets).then(function(e){if(e.result){var a=[{customer:"",desc:"请选择客户"}];t.form.customer="",e.data.forEach(function(t){a.push({customer:t.bsCode,desc:t.bsName})}),t.customers=a,t.customers.length>1&&(t.form.customer=t.customers[1].customer),t.initAgent()}})},initAgent:function(){var t=this;this.api.lmp.booking.getAgentByPlan(this.cabinets).then(function(e){if(e.result){if(0==e.data.length)return t.$Message.error("找不到对应的货代信息。"),void t.modalHidden();var a=[{agent:"",name:name,url:"",desc:"请选择货代"}];t.form.agent="",e.data.forEach(function(t){a.push({agent:t.bsProvider,desc:t.bsProvider})}),t.agents=a,2==t.agents.length?(t.form.agent=t.agents[1].agent,t.mutliAgent=!1):t.agents.length>2&&(t.mutliAgent=!0),t.initializeState=!0}})},loadPageView:function(){var t=this;this.api.lmp.booking.getContextByPlan({customer:this.form.customer,agent:this.form.agent}).then(function(e){if(e.result){var a=e.data;if(void 0===a||0==a.length||null===a)return void t.$Message.error("获取页面错误。");var n=e.data;t.currentContextView=n,t.api.lmp.booking.getContextData({customer:t.form.customer,agent:t.form.agent,cabinets:t.cabinets}).then(function(e){if(e.result){var a=JSON.parse((0,i.default)(e.data));t.content=a}})}})},init:function(){this.initializeState=!1,this.initCustomer()},modalHidden:function(){this.$emit("close")},handleValidate:function(t,e){"boolean"==typeof t&&!1===t&&(void 0!=e&&null!=e&&this.$Message.error(e),this.validateResult=t)}},watch:{initializeState:function(){1==this.initializeState&&this.$emit("initializeClosing")},pageView:function(){void 0!==this.form.customer&&0!=this.form.customer.length&&void 0!==this.form.agent&&0!=this.form.agent.length&&this.loadPageView()},customer:function(){this.customer.length>0&&this.initAgent()}},computed:{pageView:function(){return{customer:this.form.customer,agent:this.form.agent}}}}},1713:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",[a("i-col",{attrs:{span:"24"}},[1==t.mutliAgent?a("div",[a("div",{staticStyle:{padding:"0 0 24px","line-height":"32px","font-size":"12px"}},[a("div",{staticStyle:{display:"inline-block"}},[a("p",{staticStyle:{width:"100px",display:"inline-block","text-align":"right","margin-right":"20px"}},[t._v("客户:")]),t._v(" "),a("Select",{staticStyle:{width:"200px"},model:{value:t.form.customer,callback:function(e){t.$set(t.form,"customer",e)},expression:"form.customer"}},t._l(t.customers,function(e){return a("Option",{key:e.customer,attrs:{value:e.customer}},[t._v(t._s(e.desc))])}))],1),t._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("p",{staticStyle:{width:"100px",display:"inline-block","text-align":"right","margin-right":"20px"}},[t._v("货代:")]),t._v(" "),a("i-select",{staticStyle:{width:"200px"},model:{value:t.form.agent,callback:function(e){t.$set(t.form,"agent",e)},expression:"form.agent"}},t._l(t.agents,function(e){return a("Option",{key:e.agent,attrs:{value:e.agent}},[t._v(t._s(e.desc))])}))],1)])]):t._e(),t._v(" "),0==t.mutliAgent?a("div",[a("div",{staticStyle:{padding:"0 0 24px","line-height":"32px","font-size":"12px"}},[a("div",{staticStyle:{display:"inline-block"}},[a("p",{staticStyle:{width:"100px",display:"inline-block","text-align":"right","margin-right":"20px"}},[t._v("客户:")]),t._v(" "),a("p",{staticStyle:{width:"200px",display:"inline"}},[t._v(t._s(t.form.customer))])]),t._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("p",{staticStyle:{width:"100px",display:"inline-block","text-align":"right","margin-right":"20px"}},[t._v("货代:")]),t._v(" "),a("p",{staticStyle:{width:"200px",display:"inline"}},[t._v(t._s(t.form.agent))])])])]):t._e()])],1),t._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a(t.currentContextView,{ref:"content",tag:"component",attrs:{cabinets:t.cabinets,customer:t.form.customer,agent:t.form.agent,contentData:t.content},on:{"on-commit":t.handleCommit}})],1)],1),t._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("div",{staticStyle:{height:"86px","padding-top":"24px","background-color":"#f1f2f3"}},[a("Button",{staticStyle:{float:"right","margin-right":"60px"},attrs:{type:"success",size:"large",loading:t.loading},on:{click:t.handleSubmit}},[t._v("保存")])],1)])],1)],1)},i=[];n._withStripped=!0;var o={render:n,staticRenderFns:i};e.default=o},1788:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(72),o=n(i),r=a(98),s=a(2092),d=n(s),c=a(1153),l=n(c);e.default={created:function(){this.getData()},components:{GenerateComponent:l.default},computed:(0,o.default)({},(0,r.mapState)({menuData:function(t){return t.menuData}})),data:function(){return{generateModal:{show:!1,init:!1},start:0,end:15,boxData:[],boxData1:[],cdSendDateList:[{}],cdSendDateList1:[],formQuery:{cdCustomerItemNum:"",bsCustomer:"",bsContract:"",cdSendDate:"",cdSendDate1:""},datagrid:{queryParams:{page:1,rows:15,pkParent:-1},pagination:[15,50,100],data:{rows:[],total:0,rows1:[]},columns:[{type:"index",width:60,align:"center"},{type:"selection",width:60,align:"center"},{title:"详情",type:"expand",width:100,render:function(t,e){return t(d.default,{props:{row:e.row}})}},{title:"日期",key:"cdSendDate"},{title:"柜子型号",key:"cdCabinetModel"},{title:"运输路线",key:"cdTransCode"}]}}},methods:{getData:function(){var t=this;this.api.lmp.preplan.selectlist().then(function(e){if(e.result){t.cdSendDateList=[];for(var a=0;a<e.data.length;a++){var n=e.data[a];t.cdSendDateList.push({cdSendDate:n.day,cdTransCode:n.route,cdCabinetModel:n.model,cdCustomerNo:n.customer})}t.datagrid.data.rows=t.cdSendDateList.slice(t.start,t.end),t.datagrid.data.total=e.data.length}else t.$Message.error(e.msg)})},handleSubmit:function(){var t=this;void 0!=this.formQuery.cdSendDate&&""!=this.formQuery.cdSendDate?(this.formQuery.cdSendDate=this.formQuery.cdSendDate.trim(),this.api.lmp.preplan.selectbyDate(this.formQuery).then(function(e){if(e.result){t.cdSendDateList=[];for(var a=0;a<e.data.length;a++){var n=e.data[a];t.cdSendDateList.push({cdSendDate:n.day,cdTransCode:n.route,cdCabinetModel:n.model,cdCustomerNo:n.customer})}t.datagrid.data.rows=t.cdSendDateList.slice(t.start,t.end),t.datagrid.data.total=e.data.length}else t.$Message.error(e.msg)})):this.getData()},initModal:function(){void 0==this.boxData||""==this.boxData?this.$Message.error("请至少勾选一项"):this.$refs.generate.init()},closeModal:function(){this.generateModal.show=!1,this.getData()},showModal:function(){this.generateModal.show=!0},selectBox:function(t,e){var a=[];t.forEach(function(t){a.push({day:t.cdSendDate,route:t.cdTransCode,model:t.cdCabinetModel,customer:t.cdCustomerNo})}),this.boxData=a},selectBoxcancle:function(t,e){var a=[];t.forEach(function(t){a.push({day:t.cdSendDate,route:t.cdTransCode,model:t.cdCabinetModel,customer:t.cdCustomerNo})}),this.boxData=a},selectall:function(t){var e=[];t.forEach(function(t){e.push({day:t.cdSendDate,route:t.cdTransCode,model:t.cdCabinetModel,customer:t.cdCustomerNo})}),this.boxData=e},expandChange:function(t,e){},changePage:function(t){this.start=(t-1)*this.datagrid.queryParams.rows,this.end=t*this.datagrid.queryParams.rows,void 0!=this.formQuery.cdSendDate&&""!=this.formQuery.cdSendDate?this.handleSubmit():this.getData()},chageSize:function(t){this.datagrid.queryParams.rows=t,this.start=0,this.end=t,void 0!=this.formQuery.cdSendDate&&""!=this.formQuery.cdSendDate?this.handleSubmit():this.getData()}}}},1789:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{row:Object},created:function(){this.formQuery.cdSendDate=this.row.cdSendDate,this.formQuery.cdCabinetModel=this.row.cdCabinetModel,this.formQuery.cdTransCode=this.row.cdTransCode,this.getData()},data:function(){return{cdBoxNumSum:0,cdSendNum:0,formQuery:{cdSendDate:"",cdCabinetModel:"",cdTransCode:""},datagrid:{queryParams:{page:1,rows:15,pkParent:-1},pagination:[15,50,100],data:{rows:[],total:0,rows1:[]},columns:[{title:"物料编号",key:"cdItemNo"},{title:"客户料号",key:"cdCustomerItemNum"},{title:"柜子型号",key:"cdCabinetModel"},{title:"客户名称",key:"cdCustomerNo"},{title:"柜子装的物料的托数",key:"cdBoxNum"},{title:"柜子装的物料的数量",key:"cdSendNum"}]}}},methods:{getData:function(){var t=this;this.api.lmp.preplan.selectby(this.formQuery).then(function(e){if(e.result){t.$Message.success("查询成功");for(var a=0;a<e.data.rows.length;a++)t.cdBoxNumSum+=Number(e.data.rows[a].cdBoxNum),t.cdSendNum+=Number(e.data.rows[a].cdSendNum);e.data.rows.push({cdItemNo:"总数",cdCustomerItemNum:"--",cdCabinetModel:"--",cdCustomerNo:"--",cdBoxNum:t.cdBoxNumSum,cdSendNum:t.cdSendNum}),t.datagrid.data.rows=e.data.rows.slice(t.start,t.end),t.datagrid.data.total=e.data.total}})}}}},2092:function(t,e,a){"use strict";function n(t){c||a(2093)}Object.defineProperty(e,"__esModule",{value:!0});var i=a(1789),o=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);var s=a(2095),d=a.n(s),c=!1,l=a(1),u=n,m=l(o.a,d.a,!1,u,"data-v-5a44c70e",null);m.options.__file="src/view/logistics/infrastruct/preplantable-expand.vue",e.default=m.exports},2093:function(t,e,a){var n=a(2094);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(21)("e56fe5b0",n,!1)},2094:function(t,e,a){e=t.exports=a(20)(!1),e.push([t.i,"\n.expand-row[data-v-5a44c70e]{\n    margin-bottom: 16px;\n}\n",""])},2095:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticClass:"expand-row"}),t._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Table",{staticStyle:{height:"auto"},attrs:{data:t.datagrid.data.rows,border:"",columns:t.datagrid.columns,stripe:""}}),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}})],1)],1)],1)},i=[];n._withStripped=!0;var o={render:n,staticRenderFns:i};e.default=o},2096:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("Row",[a("i-col",[a("Form",{ref:"formQuery",staticClass:"query_area",attrs:{model:t.formQuery,"label-width":120,inline:""}},[a("Form-item",{attrs:{label:"发货日期:"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入发货日期"},model:{value:t.formQuery.cdSendDate,callback:function(e){t.$set(t.formQuery,"cdSendDate",e)},expression:"formQuery.cdSendDate"}})],1),t._v(" "),a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit()}}},[t._v("查 询")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:t.initModal}},[t._v("Booking")])],1)],1)],1)],1)],1),t._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Table",{ref:"selection",staticStyle:{height:"auto"},attrs:{data:t.datagrid.data.rows,columns:t.datagrid.columns,stripe:""},on:{"on-select-all":t.selectall,"on-expand":t.expandChange,"on-select-cancel":t.selectBoxcancle,"on-select":t.selectBox}}),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.datagrid.data.total,current:1,"page-size":t.datagrid.queryParams.rows,"page-size-opts":t.datagrid.pagination,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.chageSize}})],1)])],1)],1),t._v(" "),a("modal",{attrs:{width:"960"},model:{value:t.generateModal.show,callback:function(e){t.$set(t.generateModal,"show",e)},expression:"generateModal.show"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Row",[a("i-col",{attrs:{span:"24"}},[a("p",{staticStyle:{"font-size":"14px","margin-bottom":"12px","margin-left":"20px"}},[a("b",[t._v("Booking 信息")])])])],1)],1),t._v(" "),a("generate-component",{ref:"generate",attrs:{cabinets:t.boxData,display:1==t.generateModal.init},on:{close:t.closeModal,initializeClosing:t.showModal}}),t._v(" "),a("p",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},i=[];n._withStripped=!0;var o={render:n,staticRenderFns:i};e.default=o}});