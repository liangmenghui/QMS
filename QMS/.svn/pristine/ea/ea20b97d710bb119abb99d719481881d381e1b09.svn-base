webpackJsonp([59],{1153:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(1733),o=a.n(r);for(var s in r)"default"!==s&&function(e){a.d(t,e,function(){return r[e]})}(s);var l=a(2029),i=a.n(l),m=a(1),n=m(o.a,i.a,!1,null,null,null);n.options.__file="src/view/member/resrce/index.vue",t.default=n.exports},1733:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(30),s=r(o),l=a(19),i=r(l),m=a(16),n=r(m),d=a(98),c=r(d),p=a(3),u=r(p),f=a(97);t.default={data:function(){var e=this;return{formQuery:{bsCode:"",bsName:""},tree:{data:[{expand:!0,title:"根目录",children:[]}]},perms:{modal_dialog:!1,data:[],indeterminate:!0,checkAll:!1,checkAllGroup:[],formItem:{pkResrce:"",pkPerms:[]}},dialog:{modal_dialog:!1,formItem:{},ruleForm:(0,u.default)({bsCode:[{required:!0,message:"请填写编码",trigger:"blur"}],bsName:[{required:!0,message:"请填写名称",trigger:"blur"}],bsLeaf:[{required:!0,message:"请选择资源类型",trigger:"blur"}],bsSortNo:[{required:!0,message:"请填写序号",trigger:"blur"}],bsEnableState:[{required:!0,message:"请选择启用状态",trigger:"blur"}]},"bsLeaf",[{required:!0,message:"请选择资源类型",trigger:"blur"}])},datagrid:{queryParams:{page:1,rows:25,pkParent:-1},pagination:[25,50,100],data:{rows:[],total:0},columns:[{title:"资源编码",key:"bsCode"},{title:"资源名称",key:"bsName"},{title:"资源类型",key:"bsLeaf",render:function(e,t){return e("span",0==t.row.bsLeaf?"目录":"菜单")},align:"center"},{title:"URL",key:"bsUrl"},{title:"启用状态",key:"bsEnableState",align:"center",render:function(e,t){return e("span",1==t.row.bsEnableState?"启用":"停用")}},{title:"删除标识",key:"bsIsDel",render:function(e,t){return e("span",{style:{fontColor:"red"}},0==t.row.bsIsDel?"-":"已删除")}},{title:"创建时间",key:"bsCreatedTime"},{title:"更新时间",key:"bsModifiedTime"},{title:"操作",key:"action",render:function(t,a){var r=[];return 1==a.row.bsLeaf&&r.push(t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showAllocDialog(a)}}},"权限设置")),r.push(t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showEditDialog(a)}}},"编辑")),r.push(t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.delete(a)}}},"删除")),t("div",r)}}]}}},created:function(){this.getTree()},computed:(0,c.default)({},(0,f.mapState)({menuData:function(e){return e.menuData}})),methods:{handleSubmit:function(e){this.getData()},getData:function(){var e=this;(0,n.default)(this.formQuery,this.datagrid.queryParams),console.log("after===>"),console.log(this.formQuery),this.api.admin.resrce.getlist(this.formQuery).then(function(t){console.log("get list===>"),console.log(t.data),t.result?e.datagrid.data=t.data:e.$Message.error(t.msg)})},reloadData:function(){this.datagrid.data=this.getData()},changePage:function(e){this.datagrid.queryParams.page=e,this.datagrid.data=this.getData()},edit:function(e){var t=this;console.log(e),this.api.admin.resrce.edit(e.row).then(function(e){console.log(e),e.result?t.reloadData():t.$Message.error(e.msg)})},delete:function(e){var t=this;console.log(e),this.$Modal.confirm({title:"提示信息",content:"<p>是否确定删除？</p>",loading:!0,onOk:function(){t.api.admin.resrce.delete({id:e.row.id}).then(function(e){console.log(e),e.result?(t.getTree(),t.reloadData(),t.$Message.info("删除成功"),t.$Modal.remove()):t.$Message.error(e.msg)})}})},showAddDialog:function(){this.dialog.modal_dialog=!0;var e=this.$refs.tree.getSelectedNodes();if(0==e.length)this.dialog.formItem={pkParent:-1,parentName:"根目录",bsLevel:1,bsEnableState:1};else{var t=1;t=-1==e[0].id?1:e[0].attributes.bsLevel+1,this.dialog.formItem={pkParent:e[0].id,parentName:e[0].title,bsLevel:t,bsEnableState:1}}this.dialog.formItem.bsLevel<=2&&(this.dialog.formItem.bsLeaf=0)},showEditDialog:function(e){this.dialog.modal_dialog=!0;var t=e.row;this.dialog.formItem={id:t.id,bsCode:t.bsCode,bsName:t.bsName,bsUrl:t.bsUrl,bsLeaf:t.bsLeaf,bsLevel:t.bsLevel,bsIconCls:t.bsIconCls,bsSortNo:t.bsSortNo,bsComment:t.bsComment,bsEnableState:t.bsEnableState},this.dialog.formItem.bsLevel<=2&&(this.dialog.formItem.bsLeaf=0);var a=this.$refs.tree.getSelectedNodes();0==a.length?(0,n.default)(this.dialog.formItem,{pkParent:-1,parentName:"根目录"}):(0,n.default)(this.dialog.formItem,{pkParent:a[0].id,parentName:a[0].title})},ok:function(){var e=this;console.log("this.dialog.formItem====>"+(0,i.default)(this.dialog.formItem.id)),void 0!=(0,i.default)(this.dialog.formItem.id)&&"number"==typeof this.dialog.formItem.id?(console.log("编辑1"),console.log((0,s.default)(this.dialog.formItem)),this.api.admin.resrce.edit(this.dialog.formItem).then(function(t){t.result?(e.getTree(),e.reloadData()):e.$Message.error(t.msg)})):(console.log("新增1"),this.api.admin.resrce.add(this.dialog.formItem).then(function(t){t.result?(e.getTree(),e.reloadData()):e.$Message.error(t.msg)}))},cancel:function(){},getTree:function(){var e=this;this.api.admin.resrce.gettree({}).then(function(t){var a=[{id:-1,expand:!0,title:"根目录",children:[]}];t.result&&(console.log(e.tree.data),a[0].children=t.data,e.tree.data=a)})},selectNode:function(e){console.log("selected"),this.datagrid.queryParams.pkParent=e[0].id,this.datagrid.data=this.getData()},getSelectedNodes:function(){this.dialog.formItem.pkParent=node[0].id,console.log((0,s.default)(this.dialog.formItem))},showAllocDialog:function(e){this.perms.modal_dialog=!0,this.getPerms(e)},getPerms:function(e){var t=this,a=e.row;this.api.admin.resrceperm.getlist({pkResrce:a.id}).then(function(e){if(e.result){t.perms.data=e.data.perms;for(var r=[],o=0;o<e.data.alloced.length;o++)r.push(e.data.alloced[o].pkPerm);t.perms.formItem={pkResrce:a.id,pkPerms:r}}})},handleCheckAll:function(){if(this.perms.indeterminate?this.perms.checkAll=!1:this.perms.checkAll=!this.checkAll,this.perms.indeterminate=!1,this.perms.checkAll){for(var e=0;e<this.perms.data.length;e++)this.perms.checkAllGroup.push(this.perms.data[e].bsName);console.log(this.perms.checkAllGroup)}else this.perms.checkAllGroup=[]},checkAllGroupChange:function(e){e.length===this.perms.data.length?(this.perms.indeterminate=!1,this.perms.checkAll=!0):e.length>0?(this.perms.indeterminate=!0,this.perms.checkAll=!1):(this.perms.indeterminate=!1,this.perms.checkAll=!1)},perms_ok:function(){var e=this;if(0!=this.perms.formItem.pkPerms.length){var t=this.perms.formItem.pkPerms.join(",").toString();this.api.admin.resrceperm.save({pkResrce:this.perms.formItem.pkResrce,pkPerms:t}).then(function(t){t.result?e.$Message.info("操作成功"):e.$Message.error("操作成功")})}},perms_cancel:function(){}}}},2029:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",[a("i-col",[a("Form",{ref:"formQuery",staticClass:"query_area",attrs:{model:e.formQuery,inline:""}},[a("Form-item",{attrs:{prop:"bsCode"}},[a("Input",{attrs:{placeholder:"资源编码"},model:{value:e.formQuery.bsCode,callback:function(t){e.$set(e.formQuery,"bsCode",t)},expression:"formQuery.bsCode"}})],1),e._v(" "),a("Form-item",{attrs:{prop:"bsName"}},[a("Input",{attrs:{placeholder:"资源名称"},model:{value:e.formQuery.bsName,callback:function(t){e.$set(e.formQuery,"bsName",t)},expression:"formQuery.bsName"}})],1),e._v(" "),e.menuData.perms.QUERY?a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("formQuery")}}},[e._v("查 询")])],1):e._e(),e._v(" "),e.menuData.perms.ADD?a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.showAddDialog()}}},[e._v("新 增")])],1):e._e()],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"4"}},[a("Tree",{ref:"tree",staticClass:"layout-menu-left",attrs:{data:e.tree.data},on:{"on-select-change":e.selectNode}})],1),e._v(" "),a("i-col",{attrs:{span:"20"}},[a("Table",{attrs:{data:e.datagrid.data.rows,columns:e.datagrid.columns,stripe:"",height:"500"}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.datagrid.data.total,current:1,"page-size":e.datagrid.queryParams.rows,"page-size-opts":e.datagrid.pagination,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage}})],1)])],1)],1),e._v(" "),a("Modal",{attrs:{title:"",width:"800"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.dialog.modal_dialog,callback:function(t){e.$set(e.dialog,"modal_dialog",t)},expression:"dialog.modal_dialog"}},[a("p",[a("Form",{attrs:{model:e.dialog.formItem,rules:e.dialog.ruleForm,"label-width":80}},[a("span",{staticStyle:{display:"none"}},[a("Input",{model:{value:e.dialog.formItem.id,callback:function(t){e.$set(e.dialog.formItem,"id",t)},expression:"dialog.formItem.id"}}),e._v(" "),a("Input",{attrs:{value:"-1"},model:{value:e.dialog.formItem.pkGroup,callback:function(t){e.$set(e.dialog.formItem,"pkGroup",t)},expression:"dialog.formItem.pkGroup"}}),e._v(" "),a("Input",{attrs:{value:"-1"},model:{value:e.dialog.formItem.pkOrg,callback:function(t){e.$set(e.dialog.formItem,"pkOrg",t)},expression:"dialog.formItem.pkOrg"}}),e._v(" "),a("Input",{attrs:{value:"-1"},model:{value:e.dialog.formItem.pkParent,callback:function(t){e.$set(e.dialog.formItem,"pkParent",t)},expression:"dialog.formItem.pkParent"}}),e._v(" "),a("Input",{attrs:{value:"1"},model:{value:e.dialog.formItem.bsLevel,callback:function(t){e.$set(e.dialog.formItem,"bsLevel",t)},expression:"dialog.formItem.bsLevel"}})],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Form-item",{attrs:{label:"上级节点"}},[a("Input",{attrs:{disabled:"",placeholder:"请输入"},model:{value:e.dialog.formItem.parentName,callback:function(t){e.$set(e.dialog.formItem,"parentName",t)},expression:"dialog.formItem.parentName"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"资源编码",prop:"bsCode"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.dialog.formItem.bsCode,callback:function(t){e.$set(e.dialog.formItem,"bsCode",t)},expression:"dialog.formItem.bsCode"}})],1)],1),e._v(" "),a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"资源名称",prop:"bsName"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.dialog.formItem.bsName,callback:function(t){e.$set(e.dialog.formItem,"bsName",t)},expression:"dialog.formItem.bsName"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"资源类型",prop:"bsLeaf"}},[a("RadioGroup",{model:{value:e.dialog.formItem.bsLeaf,callback:function(t){e.$set(e.dialog.formItem,"bsLeaf",t)},expression:"dialog.formItem.bsLeaf"}},[a("Radio",{attrs:{label:1}},[a("span",[e._v("菜 单")])]),e._v(" "),a("Radio",{attrs:{label:0}},[a("span",[e._v("目 录")])])],1)],1)],1),e._v(" "),a("i-col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"启用状态",prop:"bsEnableState"}},[a("RadioGroup",{model:{value:e.dialog.formItem.bsEnableState,callback:function(t){e.$set(e.dialog.formItem,"bsEnableState",t)},expression:"dialog.formItem.bsEnableState"}},[a("Radio",{attrs:{label:1}},[a("span",[e._v("启 用")])]),e._v(" "),a("Radio",{attrs:{label:0}},[a("span",[e._v("停 用")])])],1)],1)],1),e._v(" "),a("i-col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"序号",prop:"bsSortNo"}},[a("InputNumber",{attrs:{max:9999999,min:1,placeholder:"请输入"},model:{value:e.dialog.formItem.bsSortNo,callback:function(t){e.$set(e.dialog.formItem,"bsSortNo",t)},expression:"dialog.formItem.bsSortNo"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"16"}},[a("Form-item",{attrs:{label:"URL"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.dialog.formItem.bsUrl,callback:function(t){e.$set(e.dialog.formItem,"bsUrl",t)},expression:"dialog.formItem.bsUrl"}})],1)],1),e._v(" "),a("i-col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"图标"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.dialog.formItem.bsIconCls,callback:function(t){e.$set(e.dialog.formItem,"bsIconCls",t)},expression:"dialog.formItem.bsIconCls"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Form-item",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入..."},model:{value:e.dialog.formItem.bsComment,callback:function(t){e.$set(e.dialog.formItem,"bsComment",t)},expression:"dialog.formItem.bsComment"}})],1)],1)],1)],1)],1)]),e._v(" "),a("Modal",{attrs:{title:""},on:{"on-ok":e.perms_ok,"on-cancel":e.perms_cancel},model:{value:e.perms.modal_dialog,callback:function(t){e.$set(e.perms,"modal_dialog",t)},expression:"perms.modal_dialog"}},[a("p",[a("Form",{attrs:{model:e.perms.formItem,"label-width":80}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.perms.formItem.pkResrce,expression:"perms.formItem.pkResrce"}],attrs:{type:"hidden",name:"pkResrce",value:""},domProps:{value:e.perms.formItem.pkResrce},on:{input:function(t){t.target.composing||e.$set(e.perms.formItem,"pkResrce",t.target.value)}}}),e._v(" "),a("p",[a("label",[a("input",{attrs:{type:"checkbox"}}),e._v("全选")])]),a("br"),e._v(" "),a("p",e._l(e.perms.data,function(t){return a("label",{key:t},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.perms.formItem.pkPerms,expression:"perms.formItem.pkPerms"}],attrs:{type:"checkbox",name:"pkPerms"},domProps:{value:t.id,checked:Array.isArray(e.perms.formItem.pkPerms)?e._i(e.perms.formItem.pkPerms,t.id)>-1:e.perms.formItem.pkPerms},on:{change:function(a){var r=e.perms.formItem.pkPerms,o=a.target,s=!!o.checked;if(Array.isArray(r)){var l=t.id,i=e._i(r,l);o.checked?i<0&&(e.perms.formItem.pkPerms=r.concat([l])):i>-1&&(e.perms.formItem.pkPerms=r.slice(0,i).concat(r.slice(i+1)))}else e.$set(e.perms.formItem,"pkPerms",s)}}}),e._v("  "+e._s(t.bsName)+"     ")])}))])],1)])],1)},o=[];r._withStripped=!0;var s={render:r,staticRenderFns:o};t.default=s}});