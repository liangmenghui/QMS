webpackJsonp([34],{1187:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(1902),o=a.n(r);for(var s in r)"default"!==s&&function(e){a.d(t,e,function(){return r[e]})}(s);var i=a(2081),n=a.n(i),l=a(1),d=l(o.a,n.a,!1,null,null,null);d.options.__file="src/view/erp/config/index.vue",t.default=d.exports},1902:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(22),s=r(o),i=a(14),n=r(i),l=a(72),d=r(l),u=a(11),c=r(u),m=a(98),p=a(2077),b=r(p);t.default={components:{expandRow:b.default},data:function(){var e=this;return{formQuery:{bsCode:"",bsName:""},formItem:{},dialog:{modal_dialog:!1,ruleForm:{bsCode:[{required:!0,message:"请填写编码",trigger:"blur"}],bsName:[{required:!0,message:"请填写名称",trigger:"blur"}]},datagrid:{data:{rows:[],total:0},columns:[{type:"expand",key:"bsCode",align:"center",render:function(t,a){return t(b.default,{props:{data:a},on:{returnval:function(t){var a=t.index;t.row;(0,c.default)(e.dialog.datagrid.data.rows[a],t.row)},expand:function(t){var a=t.index;e.$refs.dialogTable.toggleExpand(a)}}})}},{title:"参数编码",key:"bsCode",align:"center"},{title:"参数名称",key:"bsName",align:"center"},{title:"参数值",key:"bsValue",align:"center"},{title:"序号",key:"bsSortNo",align:"center"},{title:"参数类型",key:"bsParameterType",align:"center"},{title:"数据类型",key:"bsDataType",align:"center"},{title:"是否必须",key:"bsIsRequired",align:"center",render:function(e,t){var a=void 0;return a=1==t.row.bsIsRequired?"是":"否",e("span",a)}},{title:"操作",key:"action",width:150,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.removeRow(a)}}},"移除行")])}}]}},datagrid:{queryParams:{page:1,rows:25},pagination:[25,50,100],data:{rows:[],total:0},columns:[{title:"编码",key:"bsCode",align:"center"},{title:"名称",key:"bsName",align:"center"},{title:"存储过程名",key:"bsProcName",align:"center"},{title:"函数名",key:"bsFunctionName",align:"center"},{title:"接口版本",key:"bsRevision",align:"center"},{title:"启用状态",key:"bsEnableState",align:"center",render:function(e,t){return 1==t.row.bsEnableState?e("div","启用"):e("div","停用")}},{title:"删除标识",key:"bsIsDel",render:function(e,t){var a=void 0;return 0==t.row.bsIsDel?a="-":1==t.row.bsIsDel&&(a="已删除"),e("span",a)}},{title:"操作",key:"action",width:180,render:function(t,a){var r=[];return r.push(t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showEditDialog(a)}}},"编辑")),r.push(t("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.delete(a)}}},"删除")),r.push(t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.testInvoke(a)}}},"测试")),t("div",r)}}],subdata:{data:{rows:[],total:0},columns:[{title:"参数名",key:"bsCode",align:"center"},{title:"描述",key:"bsName",align:"center"},{title:"参数值",key:"bsValue",align:"center"},{title:"序号",key:"bsSortNo",align:"center"},{title:"参数类型",key:"bsParameterType",align:"center"},{title:"数据类型",key:"bsDataType",align:"center"},{title:"是否必须",key:"bsIsRequired",align:"center",render:function(e,t){var a=void 0;return a=1==t.row.bsIsRequired?"是":"否",e("span",a)}}]}}}},created:function(){},computed:(0,d.default)({},(0,m.mapState)({menuData:function(e){return e.menuData}})),methods:{onCurrentSelect:function(e,t){this.getSubData(e)},handleSubmit:function(e){this.getData()},getSubData:function(e){(0,c.default)(this.datagrid.subdata.data,{rows:e.details,total:e.details.length})},getData:function(){var e=this;(0,c.default)(this.formQuery,this.datagrid.queryParams),this.api.erp.apiconfig.getlist(this.formQuery).then(function(t){t.result?e.datagrid.data=t.data:e.$Message.error(t.msg)})},reloadData:function(){this.datagrid.data=this.getData()},changePage:function(e){this.datagrid.queryParams.page=e,this.datagrid.data=this.getData()},edit:function(e){var t=this;this.api.erp.apiconfig.edit(e.row).then(function(e){e.result?t.reloadData():t.$Message.error(e.msg)})},delete:function(e){var t=this;this.$Modal.confirm({title:"提示信息",content:"<p>是否确定删除？</p>",loading:!0,onOk:function(){t.api.erp.apiconfig.delete({id:e.row.id}).then(function(e){e.result?(t.reloadData(),t.$Message.info("删除成功"),t.$Modal.remove()):t.$Message.error(e.msg)})}})},showAddDialog:function(){this.dialog.modal_dialog=!0,this.formItem={},(0,c.default)(this.dialog.datagrid.data,{rows:[],total:0})},showEditDialog:function(e){this.dialog.modal_dialog=!0;var t=e.row;this.formItem={id:t.id,bsCode:t.bsCode,bsName:t.bsName,bsProcName:t.bsProcName,bsFunctionName:t.bsFunctionName,bsRevision:t.bsRevision,bsEnableState:t.bsEnableState,bsPublishDes:t.bsPublishDes,bsComment:t.bsComment},(0,c.default)(this.dialog.datagrid.data,JSON.parse((0,n.default)({rows:t.details,total:t.details.length})))},ok:function(){var e=this;this.formItem.details=this.dialog.datagrid.data.rows;(0,n.default)(this.dialog.datagrid.data.rows);void 0!=(0,s.default)(this.formItem.id)&&"number"==typeof this.formItem.id?this.$refs["dialog.ruleForm"].validate(function(t){t&&e.api.erp.apiconfig.edit(e.formItem).then(function(t){t.result?e.reloadData():e.$Message.error(t.msg)})}):this.$refs["dialog.ruleForm"].validate(function(t){t&&e.api.erp.apiconfig.add(e.formItem).then(function(t){t.result?e.reloadData():e.$Message.error(t.msg)})})},cancel:function(){},addRow:function(){this.dialog.datagrid.data.total=this.dialog.datagrid.data.total+1,this.dialog.datagrid.data.rows.push({bsCode:"",bsName:"",bsProcName:"",bsFunctionName:"",bsValue:"",bsSortNo:"",bsParameterType:"",bsDataType:""})},removeRow:function(e){this.dialog.datagrid.data.rows.splice(e.index,1)},testInvoke:function(e){for(var t=this,a={},r=e.row.details,o=void 0,s=0;s<r.length;s++)o=r[s],o.bsValue?a[o.bsCode]=o.bsValue:a[o.bsCode]="";this.api.erp.apiconfig.test(a,e.row.bsRevision,e.row.bsCode).then(function(e){e.result?t.$Message.info(e.msg):t.$Message.error(e.msg)})}}}},1903:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{data:Object},data:function(){return{visible:!0,ruleForm:{bsCode:[{required:!0,message:"请填写参数编码",trigger:"blur"}],bsName:[{required:!0,message:"请填写参数名称",trigger:"blur"}],bsProcName:[{required:!0,message:"请填写存储过程名称",trigger:"blur"}]}}},created:function(){this.row=this.data.row,this.index=this.data.index},computed:function(){},methods:{handleSubmit:function(){this.$emit("returnval",this.data),this.$emit("expand",this.data)},handleCancel:function(){this.$emit("expand",this.data)}}}},2077:function(e,t,a){"use strict";function r(e){d||a(2078)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(1903),s=a.n(o);for(var i in o)"default"!==i&&function(e){a.d(t,e,function(){return o[e]})}(i);var n=a(2080),l=a.n(n),d=!1,u=a(1),c=r,m=u(s.a,l.a,!1,c,"data-v-600bc569",null);m.options.__file="src/view/erp/config/table-expand.vue",t.default=m.exports},2078:function(e,t,a){var r=a(2079);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(19)("1c0c5722",r,!1)},2079:function(e,t,a){t=e.exports=a(18)(!1),t.push([e.i,"\n.expand-row[data-v-600bc569]{\n    margin-bottom: 0px;\n}\n",""])},2080:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Form",{attrs:{rules:e.ruleForm,"label-width":80}},[a("Row",{staticClass:"expand-row"},[a("Col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"参数编码"}},[a("Input",{attrs:{placeholder:"请输入..."},model:{value:e.row.bsCode,callback:function(t){e.$set(e.row,"bsCode",t)},expression:"row.bsCode"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"参数名称"}},[a("Input",{attrs:{placeholder:"请输入..."},model:{value:e.row.bsName,callback:function(t){e.$set(e.row,"bsName",t)},expression:"row.bsName"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"8"}},[a("Form-item",{attrs:{label:"参数值"}},[a("Input",{attrs:{placeholder:"请输入..."},model:{value:e.row.bsValue,callback:function(t){e.$set(e.row,"bsValue",t)},expression:"row.bsValue"}})],1)],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"4"}},[a("Form-item",{attrs:{label:"序号"}},[a("InputNumber",{staticStyle:{width:"50px"},attrs:{max:9999999,min:1},model:{value:e.row.bsSortNo,callback:function(t){e.$set(e.row,"bsSortNo",t)},expression:"row.bsSortNo"}})],1)],1),e._v(" "),a("Col",{attrs:{span:"6"}},[a("Form-item",{attrs:{label:"是否必须"}},[a("RadioGroup",{model:{value:e.row.bsIsRequired,callback:function(t){e.$set(e.row,"bsIsRequired",t)},expression:"row.bsIsRequired"}},[a("Radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("Radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1),e._v(" "),a("Col",{attrs:{span:"7"}},[a("Form-item",{attrs:{label:"参数类型"}},[a("Select",{model:{value:e.row.bsParameterType,callback:function(t){e.$set(e.row,"bsParameterType",t)},expression:"row.bsParameterType"}},[a("Option",{attrs:{value:1}},[e._v("Parameter In")]),e._v(" "),a("Option",{attrs:{value:2}},[e._v("Parameter Out")])],1)],1)],1),e._v(" "),a("Col",{attrs:{span:"7"}},[a("Form-item",{attrs:{label:"数据类型"}},[a("Select",{model:{value:e.row.bsDataType,callback:function(t){e.$set(e.row,"bsDataType",t)},expression:"row.bsDataType"}},[a("Option",{attrs:{value:1}},[e._v("Integer")]),e._v(" "),a("Option",{attrs:{value:2}},[e._v("String")]),e._v(" "),a("Option",{attrs:{value:3}},[e._v("Float")]),e._v(" "),a("Option",{attrs:{value:4}},[e._v("Double")]),e._v(" "),a("Option",{attrs:{value:5}},[e._v("BigDecimal")]),e._v(" "),a("Option",{attrs:{value:6}},[e._v("Cursor")])],1)],1)],1)],1),e._v(" "),a("Row",[e.visible?a("Col",{attrs:{span:"24",align:"center"}},[a("Button",{attrs:{type:"primary",size:"small"},on:{click:e.handleCancel}},[e._v("取 消")]),e._v("       \n            "),a("Button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSubmit}},[e._v("保 存")])],1):e._e()],1)],1)],1)},o=[];r._withStripped=!0;var s={render:r,staticRenderFns:o};t.default=s},2081:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",[a("i-col",[a("Form",{ref:"formQuery",staticClass:"query_area",attrs:{model:e.formQuery,inline:""}},[a("Form-item",{attrs:{prop:"bsCode"}},[a("Input",{attrs:{type:"text",placeholder:"编码"},model:{value:e.formQuery.bsCode,callback:function(t){e.$set(e.formQuery,"bsCode",t)},expression:"formQuery.bsCode"}})],1),e._v(" "),a("Form-item",{attrs:{prop:"bsName"}},[a("Input",{attrs:{type:"text",placeholder:"名称"},model:{value:e.formQuery.bsName,callback:function(t){e.$set(e.formQuery,"bsName",t)},expression:"formQuery.bsName"}})],1),e._v(" "),a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("formQuery")}}},[e._v("查 询")])],1),e._v(" "),a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.showAddDialog()}}},[e._v("新 增")])],1)],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("b",[e._v("接口配置表头")])])],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Table",{ref:"tableHeader",attrs:{data:e.datagrid.data.rows,"highlight-row":"",columns:e.datagrid.columns,stripe:"",height:"220"},on:{"on-current-change":e.onCurrentSelect}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.datagrid.data.total,current:1,"page-size":e.datagrid.queryParams.rows,"page-size-opts":e.datagrid.pagination,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage}})],1)])],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("b",[e._v("接口参数明细")])])],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Table",{attrs:{data:e.datagrid.subdata.data.rows,columns:e.datagrid.subdata.columns,stripe:"",height:"325"}})],1)],1),e._v(" "),a("Modal",{attrs:{title:"",width:"800"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.dialog.modal_dialog,callback:function(t){e.$set(e.dialog,"modal_dialog",t)},expression:"dialog.modal_dialog"}},[a("p",[a("Form",{ref:"dialog.ruleForm",attrs:{model:e.formItem,rules:e.dialog.ruleForm,"label-width":80}},[a("Row",[a("Input",{attrs:{type:"hidden"},model:{value:e.formItem.id,callback:function(t){e.$set(e.formItem,"id",t)},expression:"formItem.id"}}),e._v(" "),a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"编码",prop:"bsCode"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.bsCode,callback:function(t){e.$set(e.formItem,"bsCode",t)},expression:"formItem.bsCode"}})],1)],1),e._v(" "),a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"名称",prop:"bsName"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.bsName,callback:function(t){e.$set(e.formItem,"bsName",t)},expression:"formItem.bsName"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"存储过程名",prop:"bsProcName"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.bsProcName,callback:function(t){e.$set(e.formItem,"bsProcName",t)},expression:"formItem.bsProcName"}})],1)],1),e._v(" "),a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"函数名",prop:"bsFunctionName"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.bsFunctionName,callback:function(t){e.$set(e.formItem,"bsFunctionName",t)},expression:"formItem.bsFunctionName"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"版本号",prop:"bsRevision"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.formItem.bsRevision,callback:function(t){e.$set(e.formItem,"bsRevision",t)},expression:"formItem.bsRevision"}})],1)],1),e._v(" "),a("i-col",{attrs:{span:"12"}},[a("Form-item",{attrs:{label:"启用状态",prop:"bsEnableState"}},[a("Select",{model:{value:e.formItem.bsEnableState,callback:function(t){e.$set(e.formItem,"bsEnableState",t)},expression:"formItem.bsEnableState"}},[a("Option",{attrs:{value:1}},[e._v("启 用")]),e._v(" "),a("Option",{attrs:{value:0}},[e._v("停 用")])],1)],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Form-item",{attrs:{label:"停用信息",prop:"bsPublishDes"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入..."},model:{value:e.formItem.bsPublishDes,callback:function(t){e.$set(e.formItem,"bsPublishDes",t)},expression:"formItem.bsPublishDes"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Form-item",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入..."},model:{value:e.formItem.bsComment,callback:function(t){e.$set(e.formItem,"bsComment",t)},expression:"formItem.bsComment"}})],1)],1)],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"12"}},[a("Button",{attrs:{type:"primary",size:"small"},on:{click:e.addRow}},[e._v("新增行")]),e._v("  \n                ")],1),e._v(" "),a("i-col",{attrs:{span:"12"}})],1),e._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Table",{ref:"dialogTable",attrs:{data:e.dialog.datagrid.data.rows,"highlight-row":"",columns:e.dialog.datagrid.columns,stripe:"",height:"325"}})],1)],1)],1)],1)])],1)},o=[];r._withStripped=!0;var s={render:r,staticRenderFns:o};t.default=s}});