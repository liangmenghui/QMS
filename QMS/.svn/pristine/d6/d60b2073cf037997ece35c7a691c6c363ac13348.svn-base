webpackJsonp([90],{1209:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(1927),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,function(){return o[t]})}(r);var n=a(2115),s=a.n(n),l=a(1),d=l(i.a,s.a,!1,null,null,null);d.options.__file="src/view/logistics/booking/list.vue",e.default=d.exports},1927:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(11),i=function(t){return t&&t.__esModule?t:{default:t}}(o);a(98);e.default={data:function(){var t=this;return{modal_dialog:!1,form:{day:""},defaultFileList:[],formItem:{},datagrid:{queryParams:{page:1,rows:15,pkParent:-1},pagination:[15,50,100],data:{rows:[],total:0},columns:[{title:" ",key:"Id",type:"index",width:60,align:"center"},{title:"Booking 日期",key:"bsBookingDay"},{title:"客户",key:"bsCustomer"},{title:"货代",key:"bsAgent"},{title:"运输路线",key:"bsRouter"},{title:"柜子数量",key:"bsContainerQty"},{title:"SO",key:"bsSO"},{title:"状态",key:"bsState",width:120,align:"center",render:function(t,e){var a="";return 0==e.row.bsState?a="已保存":3==e.row.bsState&&(a="已确认"),t("b",a)}},{title:" ",key:"action",width:160,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleUpdateSO(a.row)}}},"更新SO"),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleDownload(a.row)}}},"下载")])}}]}}},methods:{uploadBefore:function(t){return""==this.formItem.bsSO||void 0==this.formItem.bsSO?(this.$Message.error("请填写SO信息"),!1):void 0!==this.formItem.bsSOAttachment&&this.formItem.bsSOAttachment.length>0?(this.$Message.error("附件已存在，请选择其他Booking订单"),!1):void 0},uploadSuccess:function(t,e,a){t.result&&(this.formItem.bsSOAttachment=t.data,this.handleSubmit())},uploadError:function(){this.$Message.error("上传文件失败，请重新上传")},ok:function(){var t=this;return""==this.formItem.bsSO||void 0==this.formItem.bsSO?void this.$Message.error("请填写SO信息"):this.formItem.bsState>=3?void this.$Message.error("SO 已设置,请选择其他Booking订单"):void this.api.lmp.booking.updateSO(this.formItem).then(function(e){e.result&&(t.handleSubmit(),t.$Message.success("更新成功"))})},handleSubmit:function(){var t=this,e={};(0,i.default)(e,this.form),(0,i.default)(e,this.datagrid.queryParams),this.api.lmp.booking.paging(e).then(function(e){e.result&&(t.datagrid.data=e.data)})},handleSelectDay:function(t){this.form.day=t},handleDownload:function(t){var e=this;this.api.lmp.booking.download({Id:t.id}).then(function(t){0==t.result&&e.$Message.error(t.msg)})},handleUpdateSO:function(t){(0,i.default)(this.formItem,t),this.$refs.upload.clearFiles(),this.defaultFileList.push({name:this.formItem.bsSOAttachment}),this.modal_dialog=!0},handleBooking:function(){this.$Util.open("CHJH")},handleCancel:function(){},changePage:function(t){this.datagrid.queryParams.page=t,this.handleSubmit()},chageSize:function(t){this.datagrid.queryParams.rows=t,this.datagrid.queryParams.page=1,this.handleSubmit()}}}},2115:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("Row",[a("i-col",[a("Form",{attrs:{model:t.form,"label-width":120,inline:""}},[a("Form-item",{attrs:{label:"Booking 日期:"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择日期"},on:{"on-change":t.handleSelectDay}})],1),t._v(" "),a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("查 询")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:t.handleBooking}},[t._v("Booking")])],1)],1)],1)],1)],1),t._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("Table",{ref:"datagrid",attrs:{data:t.datagrid.data.rows,columns:t.datagrid.columns,height:"700",stripe:""}}),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.datagrid.data.total,current:1,"page-size":t.datagrid.queryParams.rows,"page-size-opts":t.datagrid.pagination,"default-file-list":t.defaultFileList,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.chageSize}})],1)])],1)],1),t._v(" "),a("Modal",{attrs:{title:""},on:{"on-ok":function(e){t.ok()},"on-cancel":t.handleCancel},model:{value:t.modal_dialog,callback:function(e){t.modal_dialog=e},expression:"modal_dialog"}},[a("p",{staticStyle:{color:"rgb(99, 168, 168)","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),t._v(" "),a("span",[t._v("添加SO信息")])],1),t._v(" "),a("p"),a("div",[a("Row",[a("i-col",[a("Form",{staticStyle:{padding:"24px 6px 0px 6px"},attrs:{model:t.formItem,"label-width":80}},[a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"SO",prop:"bsSO"}},[a("Input",{attrs:{placeholder:"请输入SO"},model:{value:t.formItem.bsSO,callback:function(e){t.$set(t.formItem,"bsSO",e)},expression:"formItem.bsSO"}})],1)],1)],1),t._v(" "),a("Row",[a("i-col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"已上传附件"}},[a("i-input",{attrs:{readonly:"readonly",disabled:""},model:{value:t.formItem.bsSOAttachment,callback:function(e){t.$set(t.formItem,"bsSOAttachment",e)},expression:"formItem.bsSOAttachment"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",[a("Upload",{ref:"upload",attrs:{type:"drag",action:"admin/lmp/booking/updateSOFile",data:{id:this.formItem.id},"before-upload":t.uploadBefore,"on-success":t.uploadSuccess,"on-error":t.uploadError}},[a("div",{staticStyle:{padding:"20px 0"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"40"}}),t._v(" "),a("p",[t._v("请选择文件")])],1)])],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("p")])],1)},i=[];o._withStripped=!0;var r={render:o,staticRenderFns:i};e.default=r}});