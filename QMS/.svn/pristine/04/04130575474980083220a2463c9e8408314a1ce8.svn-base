webpackJsonp([1],{1292:function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(16),r=s(a),i=o(30),n=s(i);t.default={props:["approvedItemRecord","type","data","sampleRegularRecords"],data:function(){return{showFailedModel:!1,showSuccessModel:!1,showRejectModel:!1,isCoach:1,resultDesc:"",flowDesc:""}},created:function(){},mounted:function(){},methods:{showModel:function(e){3==e?this.showFailedModel=!0:2==e?this.showRejectModel=!0:this.showSuccessModel=!0},approved:function(e){var t=this;if(0!=e){var o={bsItemsId:this.approvedItemRecord.itemsBy.id,bsItemsRecordId:this.approvedItemRecord.id,bsResult:e,itemsDesc:this.flowDesc,resultDesc:this.resultDesc};this.api.Audit.approved(o).then(function(o){t.$Message.info("提交审核结果完成"),t.bsStatus=e;var s=t.$route.matched[t.$route.matched.length-2].path,a={path:s,query:{bsFlowRecordId:t.$route.query.bsFlowRecordId,refresh:!0}};t.$router.replace(a)})}},saveRecord:function(e){var t=this;if("audits"==this.type){for(var o=new Array,s=this.data,a=0;a<s.length;a++){var i={};i.bsItemsRecoreId=this.approvedItemRecord.id,i.bsTermsId=s[a].ID,i.bsScore=s[a].BS_SCORE,i.bsDesc=s[a].BS_DESC,void 0!=s[a].SCORE_ID&&(i.id=s[a].SCORE_ID),o.push(i)}(0,n.default)(o);this.api.Audit.records({approvedTermsScoreStr:(0,n.default)(o)}).then(function(o){t.$emit("updateTermsRecord"),t.$Message.info("保存成功"),t.approved(e)})}else if("inspect"==this.type){var l=(0,r.default)({},this.data);if(l=this.$Util.formattedParams(l),this.api.shipmentInspect.edit(l).then(function(o){t.$Message.info("保存成功"),t.approved(e)}),void 0!=this.sampleRegularRecords){for(var l={bsShipmentInspectId:l.id},d=[],a=0;a<this.sampleRegularRecords.length;a++)for(var p=this.sampleRegularRecords[a],c=0;c<p.records.length;c++){var u=p.records[c];d.push(this.$Util.formattedParams(u))}l.sampleRegularRecordStr=(0,n.default)(d),this.api.sampleRegularRecord.add(l).then(function(e){t.$emit("saved")})}}else if("quality"==this.type){var l=(0,r.default)({},this.data);l=this.$Util.formattedParams(l),this.api.qualityInspect.edit(l).then(function(o){t.$Message.info("保存成功"),t.approved(e)})}else this.approved(e)}}}},1293:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["approvedData","isCoach"],data:function(){return{}}}},1317:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(1292),a=o.n(s);for(var r in s)"default"!==r&&function(e){o.d(t,e,function(){return s[e]})}(r);var i=o(1318),n=o.n(i),l=o(1),d=l(a.a,n.a,!1,null,null,null);d.options.__file="src/views/qms/components/approvedAction.vue",t.default=d.exports},1318:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"component"},[o("center",[o("el-button",{staticStyle:{padding:"7px 20px"},attrs:{type:"primary"},on:{click:function(t){e.saveRecord(0)}}},[o("i",{staticClass:"el-icon-news"}),e._v("  "+e._s(e.$t("Button.SaveChanges"))+"\n        ")]),e._v(" "),e.approvedItemRecord.bsStatus>0&&e.approvedItemRecord.bsStep>1?o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"warning"},on:{click:function(t){e.showModel(2)}}},[o("i",{staticClass:"el-icon-warning"}),e._v("  "+e._s(e.$t("Button.DismissReview"))+"\n        ")]):e._e(),e._v(" "),e.approvedItemRecord.bsStatus>0?o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"danger"},on:{click:function(t){e.showModel(3)}}},[o("i",{staticClass:"el-icon-close"}),e._v("  "+e._s(e.$t("Button.AuditFailed"))+"\n        ")]):e._e(),e._v(" "),e.approvedItemRecord.bsStatus>0?o("el-button",{staticStyle:{padding:"7px 20px","margin-left":"3%"},attrs:{type:"success"},on:{click:function(t){e.showModel(1)}}},[o("i",{staticClass:"el-icon-check"}),e._v("  "+e._s(e.$t("Button.Approved"))+"\n        ")]):e._e(),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(3)}},model:{value:e.showFailedModel,callback:function(t){e.showFailedModel=t},expression:"showFailedModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#F56C6C"}},[e._v(e._s(e.$t("approved.failed_approved")))]),e._v(" "),o("el-form-item",{attrs:{label:e.$t("approved.result_comment")}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("approved.item_comment")}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(1)}},model:{value:e.showSuccessModel,callback:function(t){e.showSuccessModel=t},expression:"showSuccessModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#67C23A"}},[e._v(e._s(e.$t("approved.comfirm_approved")))]),e._v(" "),o("el-form-item",{attrs:{label:e.$t("approved.result_comment")}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("approved.item_comment")}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1),e._v(" "),o("Modal",{on:{"on-ok":function(t){e.saveRecord(2)}},model:{value:e.showRejectModel,callback:function(t){e.showRejectModel=t},expression:"showRejectModel"}},[o("el-form",{attrs:{"label-width":"80"}},[o("p",{staticStyle:{"font-size":"16px",color:"#F56C6C"}},[e._v(e._s(e.$t("approved.reject_approved")))]),e._v(" "),o("el-form-item",{attrs:{label:e.$t("approved.result_comment")}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.flowDesc,callback:function(t){e.flowDesc=t},expression:"flowDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("approved.item_comment")}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.resultDesc,callback:function(t){e.resultDesc=t},expression:"resultDesc"}})],1)],1)],1)],1)],1)},a=[];s._withStripped=!0;var r={render:s,staticRenderFns:a};t.default=r},1319:function(e,t,o){"use strict";function s(e){d||o(1320)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1293),r=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);var n=o(1322),l=o.n(n),d=!1,p=o(1),c=s,u=p(r.a,l.a,!1,c,null,null);u.options.__file="src/views/qms/components/approvedResultRecord.vue",t.default=u.exports},1320:function(e,t,o){var s=o(1321);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(29)("510cd950",s,!1)},1321:function(e,t,o){t=e.exports=o(28)(!1),t.push([e.i,"\n.component{margin-top: 30px;\n}\n",""])},1322:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"component"},[o("Card",[o("p",{staticStyle:{display:"inline"},attrs:{slot:"title"},slot:"title"},[e._v("审核状态: "+e._s(e.$t("approved.status["+e.approvedData.bsStatus+"]")))]),e._v(" "),o("p",{staticStyle:{display:"inline","margin-left":"30px"},attrs:{slot:"title"},slot:"title"},[e._v("结果说明: "+e._s(e.approvedData.bsDesc))]),e._v(" "),e.approvedData.resultSet.length>0?o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.approvedData.resultSet}},[o("el-table-column",{attrs:{label:"审核结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0==e.isCoach?o("span",[e._v(e._s(e.$t("approved.itemResultDesc["+t.row.bsResult+"]")))]):e._e(),e._v(" "),void 0!=e.isCoach?o("span",[e._v(e._s(e.$t("approved.coachResultDesc["+t.row.bsResult+"]")))]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"resultBy.bsName",label:"负责人"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bsDesc",label:"审核意见"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bsCreatedTime",label:"时间"}})],1)],1):e._e()])],1)},a=[];s._withStripped=!0;var r={render:s,staticRenderFns:a};t.default=r},1395:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(16),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={props:["fileList","canUpload"],data:function(){return{dialogImageUrl:"",dialogVisible:!1,file:[]}},created:function(){this.fileList.map(function(e){return e.name=e.fsFileBy.bsName+e.fsFileBy.bsFileType,e})},methods:{handleRemove:function(e,t){var o=this;if(e.id&&canUpload){var s={id:e.id};this.api.approvedItemsRecordFile.delete(s).then(function(e){e.result?(o.fileList.remove(),o.$Message.info("删除成功")):o.$Message.error(e.msg)})}},handleUpload:function(e){return this.file=e,this.getData(),!0},getData:function(){var e=this,t=new FormData;t.append("file",this.file),t.append("bsItemsRecordId",this.$route.query.itemsRecordId),this.api.approvedItemsRecordFile.add(t).then(function(t){if(t.result){var o=(0,a.default)(t.data,{name:e.file.name});e.fileList.push(o)}else e.$Message.error(t.msg)})},downloadFile:function(e){var t={fsFileId:e.fsFileId};this.api.fileQms.getfile(t).then(function(e){e.click()})}}}},164:function(e,t,o){"use strict";function s(e){d||o(2147)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1800),r=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);var n=o(2149),l=o.n(n),d=!1,p=o(1),c=s,u=p(r.a,l.a,!1,c,null,null);u.options.__file="src/views/qms/view/approved/ApprovedExtraReports.vue",t.default=u.exports},1688:function(e,t,o){"use strict";function s(e){d||o(1689)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1395),r=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);var n=o(1691),l=o.n(n),d=!1,p=o(1),c=s,u=p(r.a,l.a,!1,c,null,null);u.options.__file="src/views/qms/components/upload.vue",t.default=u.exports},1689:function(e,t,o){var s=o(1690);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(29)("3905d981",s,!1)},1690:function(e,t,o){t=e.exports=o(28)(!1),t.push([e.i,"\n.Uploadbox{margin-top:15px;\n}\n.el-upload--text {\n    background-color: #fff;\n    border: none;\n    border-radius: 6px;\n    box-sizing: border-box;\n  \n    text-align: center;\n    cursor: pointer;\n    position: relative;\n}\n.el-upload-list__item{width: 60%;\n}\n",""])},1691:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-upload",{staticClass:"upload-demo",attrs:{action:"","before-upload":e.handleUpload,"on-preview":e.downloadFile,"on-remove":e.handleRemove,"file-list":e.fileList}},[e.canUpload?o("el-button",{attrs:{size:"small",type:"success",plain:"",icon:"el-icon-plus"}},[e._v("\n    "+e._s(e.$t("upcoming.UploadAttachment"))+"\n  ")]):e._e(),e._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)},a=[];s._withStripped=!0;var r={render:s,staticRenderFns:a};t.default=r},1800:function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(31),r=s(a),i=o(1688),n=s(i),l=o(1317),d=s(l),p=o(1319),c=s(p);t.default={components:{ApprovedAction:d.default,Upload:n.default,ApprovedResultRecord:c.default},data:function(){return{dialogImageUrl:"",dialogVisible:!1,file:{},perms:{},approvedItemRecord:{}}},created:function(){this.approvedItemRecord=this.$store.getters.getItemRecordData,this.approvedItemRecord.bsSuppId?this.supplierInfo=this.$store.getters.getSupplierData:this.productInfo=this.$store.getters.getProductData,void 0==this.approvedItemRecord.fileSet&&(this.approvedItemRecord.fileSet=[]),this.perms.edit=(this.approvedItemRecord.users[this.approvedItemRecord.bsStep-1]==r.default.get("user")||this.$Util.hasPerm("EDIT"))&&1==this.approvedItemRecord.bsStatus},methods:{handleRemove:function(e,t){var o=this,s={fsFileId:e.fsFileId};this.api.approvedItemsRecordFile.delete(s).then(function(e){o.fileList.remove(),o.$Message.info("删除成功")})},handleUpload:function(e){return this.file=e,this.getData(),!1}}}},2147:function(e,t,o){var s=o(2148);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o(29)("49924d6d",s,!1)},2148:function(e,t,o){t=e.exports=o(28)(!1),t.push([e.i,"\n.approvedextrareports #other-body{\n\t\tmargin-bottom: 30px;\n}\n.approvedextrareports #other-body-div1{\n\t\tfont-size: 14px;\n\t\tpadding-top: 20px;padding-left: 1%;padding-right: 1%;\n}\n.approvedextrareports .td1{\n\t\twidth: 25%;\n\t\theight: 50px;\n\t\ttext-align: center;\n}\n.approvedextrareports #bottom{\n\t\tbackground-color: white;padding-top: 60px;padding-bottom:100px;padding-left: 5%;\n}\n.td{padding: 10px; text-align:center;\n}\n.td .el-upload--text{\n\t\tborder: none;\n\t\tdisplay: inline-block;\n\t\twidth: 90px;\n\t\theight: 50px;\n\t\tfloat: left;\n\t\tmargin-left: 10px;\n}\n.upload  .el-upload--text{\n\t\tborder: none;\n\t\tdisplay: inline-block;\n\t\theight:50px;\n\t\twidth: 20%;\n\t\tbackground: none;\t\n\t\tposition: absolute;\n\t\tright:8%;\n\t\ttop:10px;\n\t\tmargin-left: 10px;\n}\n.fileList2 .el-upload-list{\n\t\tmargin-top:35px;\t\n    \t\n   \t\t padding: 10px;\n   \t\t border: 1px dashed #ccc;\n   \t\t width: 80%;\n}\n.fileList2 .el-upload-list__item{width:80%;\n}\n",""])},2149:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"approvedextrareports"},[o("Row",{style:{marginBottom:"20px"}},[o("center",[o("h4",{staticStyle:{"font-size":"16px"}},[e._v(e._s(e.$t("approved.OtherReportDocumentsReviewed")))])])],1),e._v(" "),o("Row",{style:{marginBottom:"20px"}},[o("Card",[o("p",{attrs:{slot:"title"},slot:"title"},[o("Icon",{staticStyle:{color:"#ff9900"},attrs:{type:"pricetag"}}),e._v("\n                     "+e._s(e.approvedItemRecord.itemsBy.bsName)+"\n               \t")],1),e._v(" "),o("div",{attrs:{id:"other-body"}},[o("div",{attrs:{id:"other-body-div1"}},[o("div",{staticClass:"fileList2",staticStyle:{padding:"0 15px"}},[o("upload",{attrs:{fileList:e.approvedItemRecord.fileSet,canUpload:e.perms.edit}})],1)])]),e._v(" "),o("approvedResultRecord",{attrs:{approvedData:e.approvedItemRecord}}),e._v(" "),e.perms.edit?o("div",{attrs:{id:"bottom"}},[o("ApprovedAction",{attrs:{approvedItemRecord:e.approvedItemRecord}})],1):e._e()],1)],1)],1)},a=[];s._withStripped=!0;var r={render:s,staticRenderFns:a};t.default=r}});